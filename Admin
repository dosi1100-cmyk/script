-- Version: v8.9
local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local StarterGui = game:GetService("StarterGui")
local RunService = game:GetService("RunService")
local MarketplaceService = game:GetService("MarketplaceService")
local Lighting = game:GetService("Lighting")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local HttpService = game:GetService("HttpService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TextChatService = game:GetService("TextChatService")
local VirtualUser = game:GetService("VirtualUser")
local Workspace = game:GetService("Workspace")
local Terrain = Workspace:FindFirstChildOfClass("Terrain")
local Stats = game:GetService("Stats")
local lp = Players.LocalPlayer
local CoreGui = game:GetService("CoreGui")

-- [ì¹´ë©”ë¼ ì›ë³¸ ì„¤ì • ì €ì¥ (ì¢…ë£Œ ì‹œ ë³µêµ¬ìš©)]
local defaultCameraMode = lp.CameraMode
local defaultMinZoom = lp.CameraMinZoomDistance
local defaultMaxZoom = lp.CameraMaxZoomDistance
local defaultFOV = workspace.CurrentCamera.FieldOfView

local chatConnection
local mainInputConnection
local startTime = tick()
local serverInfoGui

local customSpawnCFrame = nil
local spawnConnection = nil
local fullbrightLoop = nil 
local savedLightingSettings = {} 

-- [FPS ë¶€ìŠ¤íŠ¸ ê´€ë ¨ ë³€ìˆ˜ ì €ì¥ìš©]
local fpsBoostEnabled = false
local fpsBoostConnection = nil
local originalLightingState = {} 
local cachedParts = {}

-- [Anti-AFK ê´€ë ¨ ë³€ìˆ˜]
local antiAfkEnabled = false
local antiAfkConnection = nil

-- [Anti-Lag ê´€ë ¨ ë³€ìˆ˜]
local antiLagEnabled = true 
local antiLagLoop = nil

-- [DelLines (CharacterAndBeamMove) ê´€ë ¨ ë³€ìˆ˜]
local delLinesEnabled = false

-- [WalkFling ê´€ë ¨ ë³€ìˆ˜]
local walkflingEnabled = false

-- [Noclip ê´€ë ¨ ë³€ìˆ˜]
local noclipConnection = nil

-- [Fly ë° VFly ê´€ë ¨ ë³€ìˆ˜]
local flyConnection = nil
local currentFlyType = nil
local flySpeed = 50
local flyObjects = {} 

-- [ë¬´í•œì í”„ ê´€ë ¨ ë³€ìˆ˜]
local infJumpConnection = nil
local previousJumpPower = nil

-- [Speed & JumpPower Loop ê´€ë ¨ ë³€ìˆ˜]
local loopSpeedConnection = nil
local loopJumpConnection = nil
local targetWalkSpeed = 16
local targetJumpPower = 50

-- [tpwalk ê´€ë ¨ ë³€ìˆ˜]
local tpwalkEnabled = false
local tpwalkStep = 1
local tpwalkConnection = nil

-- [IconESP ê´€ë ¨ ë³€ìˆ˜]
local iconEspEnabled = false
local iconEspConnection = nil
local iconEspMaxDist = 1000 

-- [PLCD ê´€ë ¨ ë³€ìˆ˜]
local plcdEnabled = false
local plcdConnection = nil

-- [PLCD ì‚­ì œ (Auto Reset) ê´€ë ¨ ë³€ìˆ˜]
local autoResetEnabled = false
local autoResetPending = false
local autoResetForced = false 
local autoResetDiedConnection = nil
local autoResetCharConnection = nil

-- [ìŒì‹ ëºì–´ê°€ê¸°(TakeFood) ê´€ë ¨ ë³€ìˆ˜]
local takeFoodEnabled = false
local takeFoodConnections = {}
local takeFoodTargets = {}

-- [ë°°ë¦¬ì–´ ë¶€ìˆ˜ê¸° ê´€ë ¨ ë³€ìˆ˜]
local barrierBreakEnabled = false
local barrierBreakConnection = nil

-- [Anti-Bomb ê´€ë ¨ ë³€ìˆ˜]
local antiBombEnabled = false
local currentOven = nil

-- [AntiInPlots ê´€ë ¨ ë³€ìˆ˜]
local antiInPlotsEnabled = false

-- [ì¹œêµ¬ ëª©ë¡ GUI ê´€ë ¨ ë³€ìˆ˜]
local friendListGui = nil
local friendListContent = nil
local friendListTitle = nil
local friendListLayout = nil

-- [ì¹œêµ¬ ìƒíƒœ ìºì‹œ]
local friendCache = {}

-- [ëª…ë ¹ ì…ë ¥ í¬ì»¤ìŠ¤ ìƒíƒœ]
local cmdFocused = false

-- [ë¡œê·¸(Webhook) ê´€ë ¨ ë³€ìˆ˜ ì„¤ì •]
local chatLogActive = false
local joinLogActive = false
local chatLogConnections = {}
local chatWebhookUrl = "https://discord.com/api/webhooks/1462782736145055957/B36epslVSmkXtbqAt6m1NWK_i7RUPifZu-ldc22gRWS0pR02xTCtr-FWnC149KnntdQA"
local joinWebhookUrl = "https://discord.com/api/webhooks/1463232242116726866/zGyM5oQ4nMkOIkOavl_Rs_phrK2TE40TR375L96YVclHzhsBFCLE01d0azVHynE2sDl7"

-- [ê´€ì „ ê´€ë ¨ ë³€ìˆ˜ ì¶”ê°€]
local viewingPlayer = nil
local viewConnection = nil

-- Executorë³„ HTTP Request í˜¸í™˜ì„± ì²˜ë¦¬
local http_request = (syn and syn.request) or (http and http.request) or http_request or (fluxus and fluxus.request) or request

-- [ì¹œêµ¬ ì•Œë¦¼ìš© GUI ì»¨í…Œì´ë„ˆ]
local friendAlertGui = Instance.new("ScreenGui")
friendAlertGui.Name = "FriendAlerts"
friendAlertGui.Parent = lp:WaitForChild("PlayerGui")
friendAlertGui.ResetOnSpawn = false
friendAlertGui.DisplayOrder = 999999999

local activeAlerts = {}

-- [ë“œë˜ê·¸ ê¸°ëŠ¥ í•¨ìˆ˜]
local function makeDraggable(frame)
    local dragging = false
    local dragInput
    local dragStart
    local startPos

    local function update(input)
        local delta = input.Position - dragStart
        frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end

    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then dragging = false end
            end)
        end
    end)

    frame.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)

    RunService.RenderStepped:Connect(function()
        if dragging and dragInput then update(dragInput) end
    end)
end

-- ==========================================
-- [ì¹œêµ¬ ëª©ë¡ GUI ê¸°ëŠ¥]
-- ==========================================
local function updateFriendList()
    if not friendListGui or not friendListGui.Enabled then return end
    if not friendListContent then return end

    for _, child in pairs(friendListContent:GetChildren()) do
        if child:IsA("TextLabel") then child:Destroy() end
    end

    local index = 1
    local friendCount = 0

    for _, p in pairs(Players:GetPlayers()) do
        if p ~= lp and lp:IsFriendsWith(p.UserId) then
            friendCount = friendCount + 1
            local lbl = Instance.new("TextLabel")
            lbl.Name = "FriendEntry"
            lbl.Size = UDim2.new(1, -10, 0, 25)
            lbl.BackgroundTransparency = 1
            lbl.TextColor3 = Color3.fromRGB(230, 230, 230)
            lbl.TextXAlignment = Enum.TextXAlignment.Left
            lbl.Font = Enum.Font.GothamSemibold
            lbl.TextSize = 14
            lbl.Text = tostring(index) .. ". " .. p.DisplayName .. " (@" .. p.Name .. ")"
            lbl.Parent = friendListContent
            index = index + 1
        end
    end

    if friendCount == 0 then
        local lbl = Instance.new("TextLabel")
        lbl.Name = "NoFriendEntry"
        lbl.Size = UDim2.new(1, -10, 0, 25)
        lbl.BackgroundTransparency = 1
        lbl.TextColor3 = Color3.fromRGB(150, 150, 150)
        lbl.TextXAlignment = Enum.TextXAlignment.Center
        lbl.Font = Enum.Font.Gotham
        lbl.TextSize = 14
        lbl.Text = "í˜„ì¬ ì ‘ì†ì¤‘ì¸ ì¹œêµ¬ê°€ ì—†ìŠµë‹ˆë‹¤."
        lbl.Parent = friendListContent
    end

    if friendListLayout then
        task.delay(0.05, function()
            local contentHeight = friendListLayout.AbsoluteContentSize.Y
            friendListContent.CanvasSize = UDim2.new(0, 0, 0, contentHeight + 10)
        end)
    end
end

local function createFriendListGui()
    if friendListGui then return end
    local sg = Instance.new("ScreenGui")
    sg.Name = "FriendListGui"
    sg.Parent = lp:WaitForChild("PlayerGui")
    sg.ResetOnSpawn = false
    sg.DisplayOrder = 999999996

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 250, 0, 300)
    frame.Position = UDim2.new(0, 20, 0.5, -150) 
    frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    frame.BorderSizePixel = 0
    frame.Parent = sg
    makeDraggable(frame)
    local corner = Instance.new("UICorner"); corner.CornerRadius = UDim.new(0, 10); corner.Parent = frame

    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, -40, 0, 40)
    title.BackgroundTransparency = 1
    title.Text = "ì¹œêµ¬ ëª©ë¡"
    title.Font = Enum.Font.GothamBold
    title.TextSize = 18
    title.TextColor3 = Color3.new(1, 1, 1)
    title.Parent = frame
    friendListTitle = title

    local closeBtn = Instance.new("TextButton")
    closeBtn.Size = UDim2.new(0, 30, 0, 30)
    closeBtn.Position = UDim2.new(1, -35, 0, 5)
    closeBtn.Text = "X"
    closeBtn.TextColor3 = Color3.new(1, 1, 1)
    closeBtn.BackgroundColor3 = Color3.fromRGB(220, 60, 60)
    closeBtn.Font = Enum.Font.GothamBold
    closeBtn.Parent = frame
    local btnCorner = Instance.new("UICorner"); btnCorner.CornerRadius = UDim.new(0, 5); btnCorner.Parent = closeBtn
    closeBtn.MouseButton1Click:Connect(function() sg.Enabled = false end)

    local scroll = Instance.new("ScrollingFrame")
    scroll.Name = "FriendScroll"
    scroll.Size = UDim2.new(1, -20, 1, -50)
    scroll.Position = UDim2.new(0, 10, 0, 45)
    scroll.BackgroundTransparency = 1
    scroll.BorderSizePixel = 0
    scroll.ScrollBarThickness = 6
    scroll.AutomaticCanvasSize = Enum.AutomaticSize.Y
    scroll.CanvasSize = UDim2.new(0, 0, 0, 0)
    scroll.Parent = frame

    local layout = Instance.new("UIListLayout")
    layout.Parent = scroll
    layout.SortOrder = Enum.SortOrder.LayoutOrder
    layout.Padding = UDim.new(0, 5)
    layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        local contentHeight = layout.AbsoluteContentSize.Y
        scroll.CanvasSize = UDim2.new(0, 0, 0, contentHeight + 10)
    end)
    friendListLayout = layout
    friendListContent = scroll
    friendListGui = sg
    friendListGui = sg
    updateFriendList()
end

local function toggleFriendList()
    if not friendListGui then createFriendListGui()
    else
        friendListGui.Enabled = not friendListGui.Enabled
        if friendListGui.Enabled then updateFriendList() end
    end
end

-- [Anti-AFK í•¨ìˆ˜ êµ¬í˜„]
local function toggleAntiAfk(state)
    if state then
        if antiAfkEnabled then return end
        antiAfkEnabled = true
        
        antiAfkConnection = lp.Idled:Connect(function()
            VirtualUser:CaptureController()
            VirtualUser:ClickButton2(Vector2.new())
        end)
        
        StarterGui:SetCore("SendNotification", {Title = "Anti-AFK ì¼œì§", Text = "20ë¶„ ì ìˆ˜ í‚¥ì„ ë°©ì§€í•©ë‹ˆë‹¤.", Duration = 3})
    else
        antiAfkEnabled = false
        if antiAfkConnection then
            antiAfkConnection:Disconnect()
            antiAfkConnection = nil
        end
        StarterGui:SetCore("SendNotification", {Title = "Anti-AFK êº¼ì§", Text = "ì´ì œ ì ìˆ˜í•˜ë©´ íŠ•ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.", Duration = 3})
    end
end

if game.PlaceId ~= 6961824067 then return end

loadstring(game:HttpGet('https://raw.githubusercontent.com/dosi1100-cmyk/script/refs/heads/main/kickalarm'))()

-- [Anti-Lag í•¨ìˆ˜]
local function toggleAntiLag(enable)
    if enable then
        if antiLagLoop then return end
        antiLagEnabled = true
        antiLagLoop = task.spawn(function()
            while antiLagEnabled do
                task.wait(0.3) 
                local fps = workspace:GetRealPhysicsFPS()
                local kbps = Stats.DataReceiveKbps
                
                if fps < 8 or kbps > 2000 then
                    game:Shutdown()
                    break
                end
            end
        end)
    else
        antiLagEnabled = false
        if antiLagLoop then 
            task.cancel(antiLagLoop) 
            antiLagLoop = nil 
        end
    end
end

-- [DelLines í•¨ìˆ˜]
local function toggleDelLines(state)
    local playerScripts = lp:FindFirstChild("PlayerScripts")
    if not playerScripts then return end

    local targetScript = playerScripts:FindFirstChild("CharacterAndBeamMove")
    
    if targetScript then
        if state then
            if not targetScript.Disabled then
                targetScript.Disabled = true
                delLinesEnabled = true
                StarterGui:SetCore("SendNotification", {Title = "DelLines ì¼œì§", Text = "CharacterAndBeamMove ìŠ¤í¬ë¦½íŠ¸ê°€ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.", Duration = 3})
            else
                StarterGui:SetCore("SendNotification", {Title = "DelLines", Text = "ì´ë¯¸ ë¹„í™œì„±í™” ë˜ì–´ìˆìŠµë‹ˆë‹¤.", Duration = 2})
            end
        else
            if targetScript.Disabled then
                targetScript.Disabled = false
                delLinesEnabled = false
                StarterGui:SetCore("SendNotification", {Title = "DelLines êº¼ì§", Text = "CharacterAndBeamMove ìŠ¤í¬ë¦½íŠ¸ê°€ ë‹¤ì‹œ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.", Duration = 3})
            else
                StarterGui:SetCore("SendNotification", {Title = "DelLines", Text = "ì´ë¯¸ í™œì„±í™” ë˜ì–´ìˆìŠµë‹ˆë‹¤.", Duration = 2})
            end
        end
    else
        StarterGui:SetCore("SendNotification", {Title = "ì˜¤ë¥˜", Text = "CharacterAndBeamMove ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.", Duration = 3})
    end
end

-- [FPS ë¶€ìŠ¤íŠ¸ ë° ë³µêµ¬ í•¨ìˆ˜]
local function toggleFpsBoost(enable)
    if enable then
        if fpsBoostEnabled then return end
        fpsBoostEnabled = true

        originalLightingState = {
            GlobalShadows = Lighting.GlobalShadows,
            FogEnd = Lighting.FogEnd,
            Brightness = Lighting.Brightness,
            OutdoorAmbient = Lighting.OutdoorAmbient,
            Ambient = Lighting.Ambient
        }

        Lighting.GlobalShadows = false
        Lighting.FogEnd = 9e9
        Lighting.Brightness = 1

        if Terrain then
            Terrain.WaterWaveSize = 0
            Terrain.WaterWaveSpeed = 0
            Terrain.WaterReflectance = 0
            Terrain.WaterTransparency = 0
        end

        local function optimizeObject(v)
            if v:IsA("BasePart") and not v:IsA("Terrain") then
                if not cachedParts[v] then
                    cachedParts[v] = {
                        Type = "BasePart",
                        Material = v.Material,
                        Reflectance = v.Reflectance,
                        CastShadow = v.CastShadow
                    }
                end
                v.Material = Enum.Material.SmoothPlastic
                v.Reflectance = 0
                v.CastShadow = false

            elseif v:IsA("Decal") or v:IsA("Texture") then
                if not cachedParts[v] then
                    cachedParts[v] = {
                        Type = "Texture",
                        Transparency = v.Transparency
                    }
                end
                v.Transparency = 1 

            elseif v:IsA("ParticleEmitter") or v:IsA("Trail") or v:IsA("Smoke") or v:IsA("Fire") or v:IsA("Sparkles") then
                if not cachedParts[v] then
                    cachedParts[v] = {
                        Type = "Effect",
                        Enabled = v.Enabled
                    }
                end
                v.Enabled = false

            elseif v:IsA("MeshPart") then
                if not cachedParts[v] then
                    cachedParts[v] = {
                        Type = "MeshPart",
                        Material = v.Material
                    }
                end
                v.Material = Enum.Material.SmoothPlastic
            end
        end

        for _, v in pairs(Workspace:GetDescendants()) do
            pcall(function() optimizeObject(v) end)
        end

        fpsBoostConnection = Workspace.DescendantAdded:Connect(function(v)
            pcall(function() optimizeObject(v) end)
        end)

        StarterGui:SetCore("SendNotification", {Title = "FPS ë¶€ìŠ¤íŠ¸ ì¼œì§", Text = "ê·¸ë˜í”½ì„ ë‚®ì¶”ê³  ì›ë³¸ ì„¤ì •ì„ ì €ì¥í–ˆìŠµë‹ˆë‹¤.", Duration = 3})

    else
        if not fpsBoostEnabled then return end
        fpsBoostEnabled = false

        if fpsBoostConnection then
            fpsBoostConnection:Disconnect()
            fpsBoostConnection = nil
        end

        if originalLightingState.GlobalShadows ~= nil then
            Lighting.GlobalShadows = originalLightingState.GlobalShadows
            Lighting.FogEnd = originalLightingState.FogEnd
            Lighting.Brightness = originalLightingState.Brightness
            Lighting.OutdoorAmbient = originalLightingState.OutdoorAmbient
            Lighting.Ambient = originalLightingState.Ambient
        else
            Lighting.GlobalShadows = true
            Lighting.FogEnd = 10000
            Lighting.Brightness = 2
        end

        for obj, data in pairs(cachedParts) do
            if obj and obj.Parent then
                pcall(function()
                    if data.Type == "BasePart" then
                        obj.Material = data.Material
                        obj.Reflectance = data.Reflectance
                        obj.CastShadow = data.CastShadow
                    elseif data.Type == "Texture" then
                        obj.Transparency = data.Transparency
                    elseif data.Type == "Effect" then
                        obj.Enabled = data.Enabled
                    elseif data.Type == "MeshPart" then
                        obj.Material = data.Material
                    end
                end)
            end
        end

        cachedParts = {}
        StarterGui:SetCore("SendNotification", {Title = "FPS ë¶€ìŠ¤íŠ¸ êº¼ì§", Text = "ì›ë˜ ê·¸ë˜í”½ ë° ì¬ì§ˆë¡œ ë³µêµ¬ë˜ì—ˆìŠµë‹ˆë‹¤.", Duration = 3})
    end
end

-- [ì±„íŒ… ë° ë¡œê·¸ í•¨ìˆ˜ë“¤]
local function sendChatMessage(msg)
    if not msg or #msg == 0 then return end
    local legacyChat = ReplicatedStorage:FindFirstChild("DefaultChatSystemChatEvents")
    if legacyChat and legacyChat:FindFirstChild("SayMessageRequest") then
        legacyChat.SayMessageRequest:FireServer(msg, "All")
    elseif TextChatService.ChatVersion == Enum.ChatVersion.TextChatService then
        local channel = TextChatService:FindFirstChild("TextChannels") and TextChatService.TextChannels:FindFirstChild("RBXGeneral")
        if channel then channel:SendAsync(msg) end
    else
        pcall(function() Players:Chat(msg) end)
    end
end

local function sendDiscordMessage(player, message)
    if not http_request then return end
    local payload = {
        content = "",
        embeds = {{
            title = "ğŸ’¬ ì±„íŒ… ë¡œê·¸ ê°ì§€",
            description = "**í”Œë ˆì´ì–´:** " .. player.DisplayName .. " (@" .. player.Name .. ")\n**ë©”ì‹œì§€:** " .. message,
            color = 3447003,
            footer = { text = "Place ID: " .. tostring(game.PlaceId) .. " | Job ID: " .. tostring(game.JobId) },
            timestamp = os.date("!%Y-%m-%dT%H:%M:%SZ")
        }}
    }
    pcall(function() http_request({ Url = chatWebhookUrl, Method = "POST", Headers = { ["Content-Type"] = "application/json" }, Body = HttpService:JSONEncode(payload) }) end)
end

local function sendJoinLeaveMessage(player, type)
    if not http_request then return end
    local titleText, colorCode, descText = "", 0, ""
    if type == "Join" then
        titleText = "ğŸŸ¢ ì„œë²„ ì ‘ì† ê°ì§€"
        colorCode = 65280 
        descText = "**" .. player.DisplayName .. " (@" .. player.Name .. ")** ë‹˜ì´ ì„œë²„ì— ì ‘ì†í–ˆìŠµë‹ˆë‹¤."
    else
        titleText = "ğŸ”´ ì„œë²„ í‡´ì¥ ê°ì§€"
        colorCode = 16711680 
        descText = "**" .. player.DisplayName .. " (@" .. player.Name .. ")** ë‹˜ì´ ì„œë²„ì—ì„œ ë‚˜ê°”ìŠµë‹ˆë‹¤."
    end
    local payload = {
        content = "",
        embeds = {{
            title = titleText,
            description = descText,
            color = colorCode,
            footer = { text = "í˜„ì¬ ì¸ì›: " .. tostring(#Players:GetPlayers()) .. "ëª… | Place ID: " .. tostring(game.PlaceId) },
            timestamp = os.date("!%Y-%m-%dT%H:%M:%SZ")
        }}
    }
    pcall(function() http_request({ Url = joinWebhookUrl, Method = "POST", Headers = { ["Content-Type"] = "application/json" }, Body = HttpService:JSONEncode(payload) }) end)
end

local function toggleChatLog(enable)
    if enable then
        if chatLogActive then return end
        chatLogActive = true
        local function hookPlayer(p)
            if chatLogConnections[p] then return end
            chatLogConnections[p] = p.Chatted:Connect(function(msg) if chatLogActive then sendDiscordMessage(p, msg) end end)
        end
        for _, p in ipairs(Players:GetPlayers()) do hookPlayer(p) end
        chatLogConnections["_PlayerAdded"] = Players.PlayerAdded:Connect(function(p) hookPlayer(p) end)
        chatLogConnections["_PlayerRemoving"] = Players.PlayerRemoving:Connect(function(p)
            if chatLogConnections[p] then chatLogConnections[p]:Disconnect() chatLogConnections[p] = nil end
        end)
        StarterGui:SetCore("SendNotification", {Title = "ì±„íŒ… ë¡œê·¸ ON", Text = "ëª¨ë“  ì±„íŒ…ì„ ë””ìŠ¤ì½”ë“œ ì›¹í›…ìœ¼ë¡œ ì „ì†¡í•©ë‹ˆë‹¤.", Duration = 3})
    else
        chatLogActive = false
        for key, conn in pairs(chatLogConnections) do if conn then conn:Disconnect() end end
        chatLogConnections = {}
        StarterGui:SetCore("SendNotification", {Title = "ì±„íŒ… ë¡œê·¸ OFF", Text = "ì „ì†¡ì„ ì¤‘ë‹¨í–ˆìŠµë‹ˆë‹¤.", Duration = 3})
    end
end

-- [IconESP ê¸°ëŠ¥]
local function removeAllIconEsp()
    for _, p in pairs(Players:GetPlayers()) do
        if p.Character then
            local head = p.Character:FindFirstChild("Head")
            if head then
                local oldGui = head:FindFirstChild("IconESP_Billboard")
                if oldGui then oldGui:Destroy() end
            end
        end
    end
end

local function toggleIconEsp(state)
    iconEspEnabled = state
    if state then
        if iconEspConnection then iconEspConnection:Disconnect() end
        iconEspConnection = RunService.RenderStepped:Connect(function()
            if not iconEspEnabled then return end
            local myChar = lp.Character
            local myRoot = myChar and myChar:FindFirstChild("HumanoidRootPart")
            if not myRoot then return end
            for _, p in pairs(Players:GetPlayers()) do
                if p ~= lp and p.Character then
                    local head = p.Character:FindFirstChild("Head")
                    local root = p.Character:FindFirstChild("HumanoidRootPart")
                    if head and root then
                        local dist = (myRoot.Position - root.Position).Magnitude
                        local bg = head:FindFirstChild("IconESP_Billboard")
                        if not bg then
                            bg = Instance.new("BillboardGui")
                            bg.Name = "IconESP_Billboard"
                            bg.Adornee = head
                            bg.Size = UDim2.new(0, 100, 0, 100)
                            bg.StudsOffset = Vector3.new(0, 3, 0)
                            bg.AlwaysOnTop = true
                            bg.Parent = head
                            local img = Instance.new("ImageLabel")
                            img.Size = UDim2.new(0, 60, 0, 60)
                            img.Position = UDim2.new(0.5, -30, 0, 0)
                            img.BackgroundTransparency = 1
                            img.Parent = bg
                            task.spawn(function()
                                local content, isReady = Players:GetUserThumbnailAsync(p.UserId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size420x420)
                                if isReady then
                                    img.Image = content
                                    local corner = Instance.new("UICorner"); corner.CornerRadius = UDim.new(1, 0); corner.Parent = img
                                end
                            end)
                            local txt = Instance.new("TextLabel")
                            txt.Size = UDim2.new(1, 0, 0, 20)
                            txt.Position = UDim2.new(0, 0, 0, 65)
                            txt.BackgroundTransparency = 1
                            txt.Text = p.DisplayName .. "\n(@"..p.Name..")"
                            txt.TextColor3 = Color3.new(1,1,1)
                            txt.TextStrokeTransparency = 0
                            txt.Font = Enum.Font.GothamBold
                            txt.TextSize = 14
                            txt.Parent = bg
                        end
                        if dist <= iconEspMaxDist then bg.Enabled = true else bg.Enabled = false end
                    end
                end
            end
        end)
        StarterGui:SetCore("SendNotification", {Title = "IconESP ì¼œì§", Text = "1000 Studs ì´ë‚´ í”Œë ˆì´ì–´ í‘œì‹œ", Duration = 3})
    else
        if iconEspConnection then iconEspConnection:Disconnect() iconEspConnection = nil end
        removeAllIconEsp()
        StarterGui:SetCore("SendNotification", {Title = "IconESP êº¼ì§", Text = "ëª¨ë“  ESPë¥¼ ì œê±°í–ˆìŠµë‹ˆë‹¤.", Duration = 2})
    end
end

-- [PLCD í•˜ì´ë¼ì´íŠ¸ ê¸°ëŠ¥]
local function togglePlcd(state)
    if state then
        plcdEnabled = true
        
        local function highlight(v)
            if v:IsA("BasePart") and v.Name == "PlayerCharacterLocationDetector" then
                if v:FindFirstChild("PLCD_Highlight") then return end
                
                local box = Instance.new("SelectionBox")
                box.Name = "PLCD_Highlight"
                box.Adornee = v
                box.Color3 = Color3.fromRGB(255, 0, 0) 
                box.LineThickness = 0.03 
                box.SurfaceTransparency = 1 
                box.Transparency = 0 
                box.Parent = v
            end
        end

        for _, v in pairs(Workspace:GetDescendants()) do
            highlight(v)
        end

        if plcdConnection then plcdConnection:Disconnect() end
        plcdConnection = Workspace.DescendantAdded:Connect(highlight)
        
        StarterGui:SetCore("SendNotification", {Title = "PLCD í‘œì‹œ", Text = "ê°ì§€ê¸° íŒŒíŠ¸ê°€ ë¹¨ê°„ í…Œë‘ë¦¬ë¡œ í‘œì‹œë©ë‹ˆë‹¤ (ë²½ ë’¤ ìˆ¨ê¹€).", Duration = 3})
    else
        plcdEnabled = false
        if plcdConnection then 
            plcdConnection:Disconnect() 
            plcdConnection = nil 
        end
        
        for _, v in pairs(Workspace:GetDescendants()) do
            if v.Name == "PlayerCharacterLocationDetector" then
                local box = v:FindFirstChild("PLCD_Highlight")
                if box then box:Destroy() end
            end
        end
        
        StarterGui:SetCore("SendNotification", {Title = "PLCD í•´ì œ", Text = "í‘œì‹œë¥¼ ì œê±°í–ˆìŠµë‹ˆë‹¤.", Duration = 3})
    end
end

-- [PLCD ì‚­ì œ(Auto Reset) ë¡œì§ êµ¬í˜„]
local function onAutoResetCharacterAdded(char)
    if not autoResetEnabled then return end
    local hum = char:WaitForChild("Humanoid", 10)
    if not hum then return end

    if autoResetPending then
        autoResetPending = false
        autoResetForced = true
        task.wait()
        if hum and hum.Health > 0 then
            hum.Health = 0 
        end
    end

    if autoResetDiedConnection then autoResetDiedConnection:Disconnect() end
    autoResetDiedConnection = hum.Died:Connect(function()
        if not autoResetEnabled then return end
        if autoResetForced then
            autoResetForced = false
        else
            autoResetPending = true
        end
    end)
end

local function toggleAutoReset(state)
    if state then
        if autoResetEnabled then return end
        autoResetEnabled = true
        
        if autoResetCharConnection then autoResetCharConnection:Disconnect() end
        autoResetCharConnection = lp.CharacterAdded:Connect(onAutoResetCharacterAdded)

        if lp.Character then
             onAutoResetCharacterAdded(lp.Character)
             local hum = lp.Character:FindFirstChild("Humanoid")
             if hum and hum.Health > 0 then
                 hum.Health = 0
             end
        end
        StarterGui:SetCore("SendNotification", {Title = "PLCD ì‚­ì œ(AutoReset)", Text = "í™œì„±í™”ë¨: ë¶€í™œ ì‹œ ìë™ ì¬ì„¤ì •ë©ë‹ˆë‹¤.", Duration = 3})
    else
        autoResetEnabled = false
        autoResetPending = false
        autoResetForced = false
        if autoResetDiedConnection then autoResetDiedConnection:Disconnect() autoResetDiedConnection = nil end
        if autoResetCharConnection then autoResetCharConnection:Disconnect() autoResetCharConnection = nil end
        StarterGui:SetCore("SendNotification", {Title = "PLCD ì‚­ì œ í•´ì œ", Text = "ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.", Duration = 3})
    end
end


-- [Noclip]
local function toggleNoclip(state)
    if state then
        if noclipConnection then noclipConnection:Disconnect() end
        noclipConnection = RunService.Stepped:Connect(function()
            if lp.Character then
                for _, v in pairs(lp.Character:GetDescendants()) do
                    if v:IsA("BasePart") and v.CanCollide then v.CanCollide = false end
                end
            end
        end)
    else
        if noclipConnection then noclipConnection:Disconnect() noclipConnection = nil end
    end
end

-- [Fly & VFly - Velocity Fly ë°©ì‹ ì ìš©]
local function startFlying(mode, speedInput)
    if flyConnection then flyConnection:Disconnect() flyConnection = nil end
    if lp.Character then
        local hum = lp.Character:FindFirstChild("Humanoid")
        if hum then hum.PlatformStand = false end
        for _, obj in pairs(flyObjects) do if obj then obj:Destroy() end end
        flyObjects = {}
        for _, v in pairs(lp.Character:GetDescendants()) do
            if v.Name == "VelocityFly_BV" or v.Name == "VelocityFly_BG" then v:Destroy() end
        end
    end

    currentFlyType = mode
    
    local desired = tonumber(speedInput)
    if desired then flySpeed = desired * 10 else flySpeed = 50 end
    if flySpeed < 1 then flySpeed = 50 end

    flyConnection = RunService.RenderStepped:Connect(function()
        local char = lp.Character
        if not char then return end
        
        local hum = char:FindFirstChild("Humanoid")
        local hrp = char:FindFirstChild("HumanoidRootPart")
        if not hum or not hrp then return end

        local targetPart = hrp
        local isInVehicle = false
        
        if mode == "vfly" and hum.SeatPart then
            targetPart = hum.SeatPart
            isInVehicle = true
            if targetPart.Parent:IsA("Model") and targetPart.Parent.PrimaryPart then
                targetPart = targetPart.Parent.PrimaryPart
            end
        end

        local bv = targetPart:FindFirstChild("VelocityFly_BV")
        local bg = targetPart:FindFirstChild("VelocityFly_BG")

        if not bv then
            bv = Instance.new("BodyVelocity")
            bv.Name = "VelocityFly_BV"
            bv.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
            bv.Velocity = Vector3.new(0, 0, 0)
            bv.Parent = targetPart
            table.insert(flyObjects, bv)
        end
        if not bg then
            bg = Instance.new("BodyGyro")
            bg.Name = "VelocityFly_BG"
            bg.P = 9e4
            bg.MaxTorque = Vector3.new(math.huge, math.huge, math.huge)
            bg.CFrame = targetPart.CFrame
            bg.Parent = targetPart
            table.insert(flyObjects, bg)
        end

        local cam = workspace.CurrentCamera
        local moveDir = Vector3.new(0, 0, 0)
        local cf = cam.CFrame
        
        if not UserInputService:GetFocusedTextBox() then
            if UserInputService:IsKeyDown(Enum.KeyCode.W) then moveDir = moveDir + cf.LookVector end
            if UserInputService:IsKeyDown(Enum.KeyCode.S) then moveDir = moveDir - cf.LookVector end
            if UserInputService:IsKeyDown(Enum.KeyCode.A) then moveDir = moveDir - cf.RightVector end
            if UserInputService:IsKeyDown(Enum.KeyCode.D) then moveDir = moveDir + cf.RightVector end
        end
        
        bv.Velocity = moveDir * flySpeed
        bg.CFrame = cf 

        if hum then
            if isInVehicle then 
                hum.PlatformStand = false 
            else 
                hum.PlatformStand = true 
            end
        end
    end)
    
    local titleText = (mode == "vfly") and "VFly (Velocity) ì¼œì§" or "Fly (Velocity) ì¼œì§"
    StarterGui:SetCore("SendNotification", {Title = titleText, Text = "ì†ë„: " .. flySpeed, Duration = 3})
end

local function stopFlying()
    if flyConnection then flyConnection:Disconnect() flyConnection = nil end
    
    for _, obj in pairs(flyObjects) do
        if obj and obj.Parent then obj:Destroy() end
    end
    flyObjects = {}
    
    if lp.Character then
        for _, v in pairs(lp.Character:GetDescendants()) do
            if v.Name == "VelocityFly_BV" or v.Name == "VelocityFly_BG" then v:Destroy() end
        end
        local hum = lp.Character:FindFirstChild("Humanoid")
        if hum then hum.PlatformStand = false end
    end
    currentFlyType = nil
end

-- [tpwalk]
local function startTpwalk(step)
    if tpwalkConnection then tpwalkConnection:Disconnect() tpwalkConnection = nil end
    tpwalkEnabled = true
    tpwalkStep = tonumber(step) or 1
    if tpwalkStep <= 0 then tpwalkStep = 1 end

    tpwalkConnection = RunService.Heartbeat:Connect(function()
        if not tpwalkEnabled then return end
        if cmdFocused then return end
        if not lp.Character then return end
        local hrp = lp.Character:FindFirstChild("HumanoidRootPart")
        if not hrp then return end
        local cam = workspace.CurrentCamera
        if not cam then return end

        local look = cam.CFrame.LookVector
        local right = cam.CFrame.RightVector
        look = Vector3.new(look.X, 0, look.Z)
        right = Vector3.new(right.X, 0, right.Z)
        
        if look.Magnitude == 0 then return end
        look = look.Unit
        if right.Magnitude == 0 then right = look:Cross(Vector3.new(0,1,0)).Unit end

        local moveDir = Vector3.new(0,0,0)
        if UserInputService:IsKeyDown(Enum.KeyCode.W) then moveDir = moveDir + look end
        if UserInputService:IsKeyDown(Enum.KeyCode.S) then moveDir = moveDir - look end
        if UserInputService:IsKeyDown(Enum.KeyCode.A) then moveDir = moveDir - right end
        if UserInputService:IsKeyDown(Enum.KeyCode.D) then moveDir = moveDir + right end

        if moveDir.Magnitude > 0 then
            local dir = moveDir.Unit
            local targetPos = hrp.Position + dir * tpwalkStep
            local lookPos = targetPos + dir
            local flatLookPos = Vector3.new(lookPos.X, targetPos.Y, lookPos.Z)

            pcall(function() 
                hrp.CFrame = CFrame.lookAt(targetPos, flatLookPos) 
            end)
        end
    end)
    StarterGui:SetCore("SendNotification", {Title = "TpWalk ì¼œì§", Text = "ìŠ¤í…: " .. tostring(tpwalkStep) .. " studs (ììœ  ì‹œì )", Duration = 4})
end

local function stopTpwalk()
    tpwalkEnabled = false
    if tpwalkConnection then tpwalkConnection:Disconnect() tpwalkConnection = nil end
    StarterGui:SetCore("SendNotification", {Title = "TpWalk êº¼ì§", Text = "ì´ì œ í…”ë ˆí¬íŠ¸ ë³´í–‰ì´ ì¤‘ì§€ë©ë‹ˆë‹¤.", Duration = 2})
end

-- ==============================================================================
-- [ ìŒì‹ ëºì–´ê°€ê¸° ê¸°ëŠ¥ (TakeFood) ]
-- ==============================================================================

local function toggleTakeFood(state)
    if state then
        if takeFoodEnabled then return end
        takeFoodEnabled = true
        if getgenv then getgenv().TakeFoodActive = true else _G.TakeFoodActive = true end

        local VoidCFrame = CFrame.new(0, -30000, 0)
        local ZeroVector = Vector3.new(0, 0, 0)
        local MySpawnFolderName = lp.Name .. "SpawnedInToys"
        
        local TargetItems = {
            ["InstrumentBrassBugle"] = true, ["InstrumentBrassTrumpet"] = true, ["InstrumentBrassVuvuzela"] = true,
            ["InstrumentDrumBongos"] = true, ["InstrumentDrumSnare"] = true, ["InstrumentGuitarAcoustic"] = true,
            ["InstrumentGuitarBanjo"] = true, ["InstrumentGuitarLyre"] = true, ["InstrumentGuitarUkulele"] = true,
            ["InstrumentGuitarViolin"] = true, ["InstrumentPianoKeyboard"] = true, ["InstrumentPianoMelodica"] = true,
            ["InstrumentVoiceMicrophone"] = true, ["InstrumentWoodwindOcarina"] = true, ["InstrumentWoodwindSaxophone"] = true,
            ["PoopPileSparkle"] = true, ["PoopPile"] = true, ["FoodSodaCan"] = true, ["FoodPizzaPepperoni"] = true,
            ["FoodPizzaCheese"] = true, ["FoodMushroomPoison"] = true, ["FoodMeatStick"] = true, ["FoodMayonnaise"] = true,
            ["FoodHotdog"] = true, ["FoodHamburger"] = true, ["FoodFrenchFries"] = true, ["FoodDonut"] = true,
            ["FoodDippyEgg"] = true, ["FoodCoconut"] = true, ["FoodCakePink"] = true, ["FoodBroccoli"] = true,
            ["FoodBread"] = true, ["FoodBanana"] = true, ["CupMugWhite"] = true, ["CupMugBrown"] = true
        }

        local function AggressiveRemove(item)
            if not takeFoodEnabled then return end
            if not item then return end
            
            if takeFoodTargets[item] then return end
            
            if not TargetItems[item.Name] then return end
            if item:IsDescendantOf(Workspace) then
                local myFolder = Workspace:FindFirstChild(MySpawnFolderName)
                if myFolder and item:IsDescendantOf(myFolder) then return end
            end

            takeFoodTargets[item] = true

            task.spawn(function()
                local holdPart = item:WaitForChild("HoldPart", 2)
                if not holdPart or not takeFoodEnabled then 
                    takeFoodTargets[item] = nil 
                    return 
                end
                
                local holdRemote = holdPart:WaitForChild("HoldItemRemoteFunction", 2)
                local dropRemote = holdPart:WaitForChild("DropItemRemoteFunction", 2)

                if holdRemote and dropRemote then
                    while takeFoodEnabled and item and item.Parent and item:IsDescendantOf(Workspace) do
                        local myFolder = Workspace:FindFirstChild(MySpawnFolderName)
                        if myFolder and item:IsDescendantOf(myFolder) then
                            takeFoodTargets[item] = nil
                            return
                        end

                        task.spawn(function()
                            pcall(function() holdRemote:InvokeServer(item, lp.Character) end)
                        end)
                        
                        task.wait(0.1) 

                        task.spawn(function()
                            pcall(function() dropRemote:InvokeServer(item, VoidCFrame, ZeroVector) end)
                        end)
                        
                        task.wait(0.1)
                    end
                    takeFoodTargets[item] = nil
                else
                    takeFoodTargets[item] = nil
                end
            end)
        end

        local function AttachDeepWatch(folder)
            if not folder then return end
            for _, descendant in pairs(folder:GetDescendants()) do
                if takeFoodEnabled then AggressiveRemove(descendant) end
            end
            local conn = folder.DescendantAdded:Connect(function(descendant)
                if takeFoodEnabled then AggressiveRemove(descendant) end
            end)
            table.insert(takeFoodConnections, conn)
        end

        local foodFolder = Workspace:FindFirstChild("Food")
        if foodFolder then AttachDeepWatch(foodFolder) end

        local plotFolder = Workspace:FindFirstChild("PlotItems")
        if plotFolder then AttachDeepWatch(plotFolder) end
        
        local function CheckAndAttach(child)
            if child:IsA("Folder") or child:IsA("Model") then
                if string.match(child.Name, "SpawnedInToys$") and child.Name ~= MySpawnFolderName then
                    AttachDeepWatch(child)
                end
            end
        end

        for _, child in pairs(Workspace:GetChildren()) do CheckAndAttach(child) end
        
        local wsConn = Workspace.ChildAdded:Connect(function(child)
            if not takeFoodEnabled then return end
            if child.Name == "Food" or child.Name == "PlotItems" then
                AttachDeepWatch(child)
            else
                CheckAndAttach(child)
            end
        end)
        table.insert(takeFoodConnections, wsConn)

        local scanLoop = task.spawn(function()
            while takeFoodEnabled do
                local itemsChecked = 0
                
                local foldersToScan = {}
                if foodFolder then table.insert(foldersToScan, foodFolder) end
                if plotFolder then table.insert(foldersToScan, plotFolder) end
                for _, child in pairs(Workspace:GetChildren()) do
                    if string.match(child.Name, "SpawnedInToys$") and child.Name ~= MySpawnFolderName then
                        table.insert(foldersToScan, child)
                    end
                end

                for _, folder in pairs(foldersToScan) do
                    if not takeFoodEnabled then break end
                    
                    local descendants = folder:GetDescendants()
                    for _, item in pairs(descendants) do
                        if not takeFoodEnabled then break end
                        
                        if TargetItems[item.Name] and not takeFoodTargets[item] then 
                            AggressiveRemove(item) 
                        end
                        
                        itemsChecked = itemsChecked + 1
                        if itemsChecked % 50 == 0 then 
                            task.wait() 
                        end
                    end
                    task.wait()
                end
                
                task.wait(0.1)
            end
        end)
        
        StarterGui:SetCore("SendNotification", {Title = "ìŒì‹ ëºì–´ê°€ê¸° ì¼œì§", Text = "ì£¼ë³€ ì•„ì´í…œì„ ìë™ìœ¼ë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤.", Duration = 3})
    else
        takeFoodEnabled = false
        if getgenv then getgenv().TakeFoodActive = false else _G.TakeFoodActive = false end
        
        for _, conn in pairs(takeFoodConnections) do
            if conn then conn:Disconnect() end
        end
        takeFoodConnections = {}
        
        takeFoodTargets = {}
        
        StarterGui:SetCore("SendNotification", {Title = "ìŒì‹ ëºì–´ê°€ê¸° êº¼ì§", Text = "ê¸°ëŠ¥ì„ ë¹„í™œì„±í™”í•˜ê³  ë£¨í”„ë¥¼ ì •ì§€í–ˆìŠµë‹ˆë‹¤.", Duration = 3})
    end
end

-- ==============================================================================
-- [ ë°°ë¦¬ì–´ ë¶€ìˆ˜ê¸° (Lí‚¤) ê¸°ëŠ¥ ]
-- ==============================================================================

local function getNil(name, class)
    if getnilinstances then
        for _, v in pairs(getnilinstances()) do
            if v.ClassName == class and v.Name == name then
                return v
            end
        end
    end
    return nil
end

local function runBrokeBarrier()
    local LocalPlayer = Players.LocalPlayer
    if not LocalPlayer then return end 

    local Character = LocalPlayer.Character
    if not Character or not Character:FindFirstChild("HumanoidRootPart") then return end

    local RootPart = Character.HumanoidRootPart
    local OriginalCFrame = RootPart.CFrame

    -- 1. ì‹ë¹µ ì†Œí™˜ (Spawn Bread)
    local spawnPos = OriginalCFrame * CFrame.new(0, 0, -5)
    task.spawn(function()
        local menuToys = ReplicatedStorage:WaitForChild("MenuToys", 5)
        if menuToys then
            local spawnRemote = menuToys:WaitForChild("SpawnToyRemoteFunction", 5)
            if spawnRemote then
                spawnRemote:InvokeServer("FoodBread", spawnPos, Vector3.zero)
            end
        end
    end)

    -- ì‹ë¹µì´ ìƒì„±ë  ë•Œê¹Œì§€ ì•„ì£¼ ì ê¹ ëŒ€ê¸° (ì•ˆì •ì„± í™•ë³´ìš©)
    task.wait(0.05)

    -- 2. ì‹ë¹µ ì¡ê¸° (Parallel Grab)
    task.spawn(function()
        local spawnedFolder = Workspace:WaitForChild(LocalPlayer.Name .. "SpawnedInToys", 3)
        if spawnedFolder then
            local breadInstance = spawnedFolder:WaitForChild("FoodBread", 2)
            if breadInstance then
                local holdPart = breadInstance:FindFirstChild("HoldPart")
                local holdRemote = holdPart and holdPart:FindFirstChild("HoldItemRemoteFunction")
                if holdRemote then
                    holdRemote:InvokeServer(breadInstance, Character)
                end
            end
        end
    end)

    -- 3. ì¡ê³  ë‚˜ì„œ 0.2ì´ˆ ëŒ€ê¸°
    task.wait(0.2)

    -- 4. í…”ë ˆí¬íŠ¸ (Teleport)
    local teslaCoil = Workspace:FindFirstChild("Plots") 
        and Workspace.Plots:FindFirstChild("Plot5") 
        and Workspace.Plots.Plot5:FindFirstChild("TeslaCoil")
        
    if teslaCoil then
        if teslaCoil:IsA("Model") then
            RootPart.CFrame = teslaCoil:GetPivot()
        elseif teslaCoil:IsA("BasePart") then
            RootPart.CFrame = teslaCoil.CFrame
        end
    end

    -- 5. í…”ë ˆí¬íŠ¸ í›„ 0.07ì´ˆ ëŒ€ê¸°
    task.wait(0.07)

    -- 6. ì‹ë¹µ ì‚­ì œ (Delete Bread)
    task.spawn(function()
        local spawnedFolder = Workspace:FindFirstChild(LocalPlayer.Name .. "SpawnedInToys")
        local targetBread = spawnedFolder and spawnedFolder:FindFirstChild("FoodBread")
        if not targetBread then targetBread = getNil("FoodBread", "Model") end

        if targetBread then
            local menuToys = ReplicatedStorage:FindFirstChild("MenuToys")
            if menuToys then
                local destroyToy = menuToys:FindFirstChild("DestroyToy")
                if destroyToy then
                    destroyToy:FireServer(targetBread)
                end
            end
        end
    end)

    -- 7. ì‚­ì œ í›„ 0.1ì´ˆ ëŒ€ê¸°
    task.wait(0.1)

    -- 8. ë³µê·€ (Return)
    if RootPart then RootPart.CFrame = OriginalCFrame end
end

local function toggleBarrierBreaker(state)
    if state then
        if barrierBreakEnabled then return end
        barrierBreakEnabled = true
        
        if barrierBreakConnection then barrierBreakConnection:Disconnect() end
        barrierBreakConnection = UserInputService.InputBegan:Connect(function(input, gpe)
            if gpe then return end
            if input.KeyCode == Enum.KeyCode.L then
                runBrokeBarrier()
            end
        end)
        StarterGui:SetCore("SendNotification", {Title = "ë°°ë¦¬ì–´ ë¶€ìˆ˜ê¸° ON", Text = "Lí‚¤ë¥¼ ëˆŒëŸ¬ ë°°ë¦¬ì–´ë¥¼ ë¶€ìˆ©ë‹ˆë‹¤.", Duration = 3})
    else
        barrierBreakEnabled = false
        if barrierBreakConnection then
            barrierBreakConnection:Disconnect()
            barrierBreakConnection = nil
        end
        StarterGui:SetCore("SendNotification", {Title = "ë°°ë¦¬ì–´ ë¶€ìˆ˜ê¸° OFF", Text = "Lí‚¤ ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.", Duration = 3})
    end
end

local function toggleAntiBarrier(state)
    local targetCollide = not state 
    local count = 0
    for i = 1, 5 do
        local folder = Workspace:FindFirstChild("Plots") and Workspace.Plots:FindFirstChild("Plot" .. i) and Workspace.Plots["Plot" .. i]:FindFirstChild("Barrier")
        if folder then
            for _, v in pairs(folder:GetChildren()) do
                if v.Name == "PlotBarrier" and v:IsA("BasePart") then
                    v.CanCollide = targetCollide
                    count = count + 1
                end
            end
        end
    end
    
    if state then
        StarterGui:SetCore("SendNotification", {Title = "AntiBarrier ì¼œì§", Text = "í”Œë¡¯ ì¥ë²½ ì¶©ëŒì„ ê»ìŠµë‹ˆë‹¤.", Duration = 3})
    else
        StarterGui:SetCore("SendNotification", {Title = "AntiBarrier êº¼ì§", Text = "í”Œë¡¯ ì¥ë²½ ì¶©ëŒì„ ë‹¤ì‹œ ì¼°ìŠµë‹ˆë‹¤.", Duration = 3})
    end
end

local function toggleOceanWalk(state)
    local oceanModel = Workspace:FindFirstChild("Map") 
        and Workspace.Map:FindFirstChild("AlwaysHereTweenedObjects") 
        and Workspace.Map.AlwaysHereTweenedObjects:FindFirstChild("Ocean") 
        and Workspace.Map.AlwaysHereTweenedObjects.Ocean:FindFirstChild("Object")
        and Workspace.Map.AlwaysHereTweenedObjects.Ocean.Object:FindFirstChild("ObjectModel")
    
    if oceanModel then
        local count = 0
        for _, v in pairs(oceanModel:GetDescendants()) do
            if v.Name == "Ocean" and v:IsA("BasePart") then
                v.CanCollide = state
                count = count + 1
            end
        end
        
        if state then
            StarterGui:SetCore("SendNotification", {Title = "OceanWalk ì¼œì§", Text = "ë°”ë‹¤ ìœ„ë¥¼ ê±¸ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.", Duration = 3})
        else
            StarterGui:SetCore("SendNotification", {Title = "OceanWalk êº¼ì§", Text = "ë‹¤ì‹œ ë¬¼ ì†ìœ¼ë¡œ ë¹ ì§‘ë‹ˆë‹¤.", Duration = 3})
        end
    else
        StarterGui:SetCore("SendNotification", {Title = "ì˜¤ë¥˜", Text = "Ocean ê²½ë¡œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.", Duration = 3})
    end
end

-- ==============================================================================
-- [ Anti-Bomb (ì˜¤ë¸ ë°©ì–´) ê¸°ëŠ¥ ]
-- ==============================================================================
local function toggleAntiBomb(state)
    if state then
        if antiBombEnabled then 
            StarterGui:SetCore("SendNotification", {Title = "ì•ˆí‹° í­íƒ„", Text = "ì´ë¯¸ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤.", Duration = 2})
            return 
        end
        antiBombEnabled = true

        task.spawn(function()
            local Character = lp.Character or lp.CharacterAdded:Wait()
            local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")
            if not HumanoidRootPart then return end

            local OriginalCFrame = HumanoidRootPart.CFrame

            local SetupCoordinate = Vector3.new(541.4873046875, -5.359338283538818, -266.456787109375)
            HumanoidRootPart.CFrame = CFrame.new(SetupCoordinate)
            task.wait(0.05) 

            local spawnRemote = ReplicatedStorage:WaitForChild("MenuToys"):WaitForChild("SpawnToyRemoteFunction")
            local spawnPos = HumanoidRootPart.CFrame * CFrame.new(0, 0, -5)
            spawnRemote:InvokeServer("OvenDarkGray", spawnPos, Vector3.new(0, 0, 0))

            local myToyFolderName = lp.Name .. "SpawnedInToys" 
            local myToyFolder = Workspace:WaitForChild(myToyFolderName, 5)
            if not myToyFolder then 
                warn("Toy í´ë”ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ")
                HumanoidRootPart.CFrame = OriginalCFrame
                antiBombEnabled = false
                return 
            end
            
            local myOven = myToyFolder:WaitForChild("OvenDarkGray", 5)
            if not myOven then
                warn("ì˜¤ë¸ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
                HumanoidRootPart.CFrame = OriginalCFrame
                antiBombEnabled = false
                StarterGui:SetCore("SendNotification", {Title = "ì•ˆí‹° í­íƒ„ ì‹¤íŒ¨", Text = "ì˜¤ë¸ ìŠ¤í°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.", Duration = 3})
                return
            end
            
            currentOven = myOven
            local ovenMain = myOven:WaitForChild("Main")

            if HumanoidRootPart and ovenMain then
                HumanoidRootPart.CFrame = ovenMain.CFrame * CFrame.new(0, 0, 10)
            end
            
            task.wait(0.05)

            local interactRemote = ReplicatedStorage:WaitForChild("GrabEvents"):WaitForChild("SetNetworkOwner")
            local ButtonSequence = {"Button1", "Button2", "ButtonOven", "Button3", "Button4"}

            local soundPart = myOven:WaitForChild("SoundPart", 2)
            if soundPart then interactRemote:FireServer(soundPart, soundPart.CFrame) end

            for _, btnName in ipairs(ButtonSequence) do
                local btn = myOven:WaitForChild(btnName, 2)
                if btn then
                    interactRemote:FireServer(btn, btn.CFrame)
                    task.wait() 
                end
            end

            if HumanoidRootPart then
                HumanoidRootPart.CFrame = OriginalCFrame
            end
            
            StarterGui:SetCore("SendNotification", {Title = "ì•ˆí‹° í­íƒ„ ì¼œì§", Text = "ì˜¤ë¸ì„ ì„¤ì¹˜í•˜ê³  ë°©ì–´ ëª¨ë“œë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.", Duration = 3})

            local TargetBombNames = {
                ["BombMissile"] = true, ["BombDarkMatter"] = true,
                ["BombBalloon"] = true, ["BallSnowball"] = true, ["BalloonModel"] = true
            }
            local SafeZoneCFrame = CFrame.new(0, 500000, 0)

            while antiBombEnabled and myOven and myOven.Parent do
                local foundTarget = nil
                local targetCFrame = nil

                for _, folder in pairs(Workspace:GetChildren()) do
                    if string.sub(folder.Name, -13) == "SpawnedInToys" then
                        if folder.Name == myToyFolderName then continue end 
                        for _, toy in pairs(folder:GetChildren()) do
                            if TargetBombNames[toy.Name] then
                                foundTarget = toy
                                break
                            end
                        end
                    end
                    if foundTarget then break end
                end
                
                if not foundTarget then
                    local balloonsFolder = Workspace:FindFirstChild("Balloons")
                    if balloonsFolder then
                        for _, toy in pairs(balloonsFolder:GetChildren()) do
                            if TargetBombNames[toy.Name] then
                                foundTarget = toy
                                break
                            end
                        end
                    end
                end

                if foundTarget and foundTarget.Parent.Name == myToyFolderName then foundTarget = nil end

                if foundTarget then
                    if foundTarget.Name == "BombBalloon" or foundTarget.Name == "BalloonModel" then
                        targetCFrame = foundTarget:GetPivot()
                    elseif foundTarget:FindFirstChild("Main") then
                        targetCFrame = foundTarget.Main.CFrame
                    end

                    if targetCFrame then
                        for i = 0.3, 5 do
                            if not foundTarget or not foundTarget.Parent then break end
                            if not antiBombEnabled then break end

                            if foundTarget.Name == "BombBalloon" or foundTarget.Name == "BalloonModel" then
                                targetCFrame = foundTarget:GetPivot()
                            elseif foundTarget:FindFirstChild("Main") then
                                targetCFrame = foundTarget.Main.CFrame
                            end
                            
                            ovenMain.CFrame = targetCFrame
                            ovenMain.Velocity = Vector3.zero
                            ovenMain.RotVelocity = Vector3.zero
                            RunService.Heartbeat:Wait()

                            ovenMain.CFrame = SafeZoneCFrame
                            ovenMain.Velocity = Vector3.zero
                            ovenMain.RotVelocity = Vector3.zero
                            RunService.Heartbeat:Wait()
                        end
                    end
                else
                    ovenMain.CFrame = SafeZoneCFrame
                    ovenMain.Velocity = Vector3.zero
                    ovenMain.RotVelocity = Vector3.zero
                    task.wait()
                end
            end
        end)
    else
        antiBombEnabled = false
        
        if currentOven and currentOven.Parent then
            local args = { currentOven }
            pcall(function()
                game:GetService("ReplicatedStorage"):WaitForChild("MenuToys"):WaitForChild("DestroyToy"):FireServer(unpack(args))
            end)
            StarterGui:SetCore("SendNotification", {Title = "ì•ˆí‹° í­íƒ„ êº¼ì§", Text = "ì„¤ì¹˜ëœ ì˜¤ë¸ì„ ì‚­ì œí–ˆìŠµë‹ˆë‹¤.", Duration = 3})
            currentOven = nil
        else
            local args = { Instance.new("Model", nil) } 
            pcall(function()
                game:GetService("ReplicatedStorage"):WaitForChild("MenuToys"):WaitForChild("DestroyToy"):FireServer(unpack(args))
            end)
            StarterGui:SetCore("SendNotification", {Title = "ì•ˆí‹° í­íƒ„ êº¼ì§", Text = "ì˜¤ë¸ ì‚­ì œ ì‹ í˜¸ë¥¼ ë³´ëƒˆìŠµë‹ˆë‹¤.", Duration = 3})
        end
    end
end


-- ==============================================================================
-- [ AntiInPlots (í”Œë¡¯ ë‚´ë¶€ ë‚©ì¹˜) ê¸°ëŠ¥ ]
-- ==============================================================================
local function toggleAntiInPlots(state)
    if state then
        if antiInPlotsEnabled then return end
        antiInPlotsEnabled = true
        
        task.spawn(function()
            local plotItems = Workspace:WaitForChild("PlotItems", 5)
            local playersInPlots = plotItems and plotItems:WaitForChild("PlayersInPlots", 5)
            
            local mySpawnFolderName = lp.Name .. "SpawnedInToys"
            local mySpawnFolder = Workspace:WaitForChild(mySpawnFolderName, 5)

            if not playersInPlots or not mySpawnFolder then
                StarterGui:SetCore("SendNotification", {Title = "ì˜¤ë¥˜", Text = "í•„ìˆ˜ í´ë”(PlotItems/SpawnedInToys)ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.", Duration = 3})
                antiInPlotsEnabled = false
                return
            end
            
            StarterGui:SetCore("SendNotification", {Title = "AntiInPlots ì¼œì§", Text = "í”Œë¡¯ ë‚´ë¶€ í”Œë ˆì´ì–´ë¥¼ ë‚©ì¹˜í•©ë‹ˆë‹¤.", Duration = 3})

            while antiInPlotsEnabled do
                if not mySpawnFolder or not mySpawnFolder.Parent then
                    mySpawnFolder = Workspace:FindFirstChild(mySpawnFolderName)
                end

                if mySpawnFolder then
                    for _, player in pairs(Players:GetPlayers()) do
                        local char = player.Character
                        if char and char.Parent then
                            local inPlot = playersInPlots:FindFirstChild(player.Name)

                            if inPlot then
                                if char.Parent ~= mySpawnFolder then
                                    pcall(function()
                                        char.Parent = mySpawnFolder
                                    end)
                                end
                            end
                        end
                    end
                end
                task.wait(0.2)
            end
        end)
    else
        antiInPlotsEnabled = false
        StarterGui:SetCore("SendNotification", {Title = "AntiInPlots êº¼ì§", Text = "ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.", Duration = 3})
    end
end


-- [ëª…ë ¹ì–´ ì²˜ë¦¬ í†µí•© í•¨ìˆ˜]
local function processCommand(msg)
    msg = msg:gsub("^%s+", ""):gsub("%s+$", "")
    if #msg == 0 then return end

    local lowerMsg = msg:lower()

    if lowerMsg == ".iconesp" or lowerMsg == ".ie" then toggleIconEsp(true)
    elseif lowerMsg == ".uniconesp" or lowerMsg == ".unie" then toggleIconEsp(false)
    elseif lowerMsg:sub(1, 6) == ".chat " then sendChatMessage(msg:sub(7))
    elseif lowerMsg:sub(1, 5) == ".say " then sendChatMessage(msg:sub(6))

    elseif lowerMsg == ".fpsboost" or lowerMsg == ".fps" then toggleFpsBoost(true)
    elseif lowerMsg == ".unfpsboost" or lowerMsg == ".unfps" then toggleFpsBoost(false)

    elseif lowerMsg == ".antiafk" then toggleAntiAfk(true)
    elseif lowerMsg == ".unantiafk" then toggleAntiAfk(false)
    
    elseif lowerMsg == ".showplcd" or lowerMsg == ".plcd" then togglePlcd(true)
    elseif lowerMsg == ".hideplcd" or lowerMsg == ".unplcd" then togglePlcd(false)

    elseif lowerMsg == ".delplcd" or lowerMsg == ".breakplcd" then 
        toggleAutoReset(true)
    elseif lowerMsg == ".undelplcd" or lowerMsg == ".unbreakplcd" then 
        toggleAutoReset(false)

    elseif lowerMsg == ".takefood" or lowerMsg == ".tf" then
        toggleTakeFood(true)
    elseif lowerMsg == ".untakefood" or lowerMsg == ".untf" then
        toggleTakeFood(false)

    elseif lowerMsg == ".antibarrier" or lowerMsg == ".barrier" then
        toggleAntiBarrier(true)
    elseif lowerMsg == ".unantibarrier" or lowerMsg == ".unbarrier" then
        toggleAntiBarrier(false)

    elseif lowerMsg == ".breakbarrier" then
        toggleBarrierBreaker(true)
    elseif lowerMsg == ".unbreakbarrier" then
        toggleBarrierBreaker(false)

    elseif lowerMsg == ".antibomb" or lowerMsg == ".ab" then
        toggleAntiBomb(true)
    elseif lowerMsg == ".unantibomb" or lowerMsg == ".unab" then
        toggleAntiBomb(false)

    elseif lowerMsg == ".antiinplots" or lowerMsg == ".aip" then
        toggleAntiInPlots(true)
    elseif lowerMsg == ".unantiinplots" or lowerMsg == ".unaip" then
        toggleAntiInPlots(false)

    elseif lowerMsg == ".dellines" or lowerMsg == ".dl" then
        toggleDelLines(true)
    elseif lowerMsg == ".undellines" or lowerMsg == ".undl" then
        toggleDelLines(false)

    elseif lowerMsg == ".oceanwalk" then
        toggleOceanWalk(true)
        
    elseif lowerMsg == ".unoceanwalk" or lowerMsg == ".unow" then
        toggleOceanWalk(false)
        
    elseif lowerMsg == ".antilag" then
        if not antiLagLoop then
            toggleAntiLag(true)
            StarterGui:SetCore("SendNotification", {Title = "Anti-Lag ì¼œì§", Text = "FPS<8 ë˜ëŠ” ìˆ˜ì‹ >2000kbps ì‹œ ìë™ ì¢…ë£Œ", Duration = 3})
        else
            StarterGui:SetCore("SendNotification", {Title = "Anti-Lag", Text = "ì´ë¯¸ ì¼œì ¸ ìˆìŠµë‹ˆë‹¤.", Duration = 2})
        end

    elseif lowerMsg == ".unantilag" then
        toggleAntiLag(false)
        StarterGui:SetCore("SendNotification", {Title = "Anti-Lag êº¼ì§", Text = "ìë™ ì¢…ë£Œ ê°ì§€ê°€ í•´ì œë˜ì—ˆìŠµë‹ˆë‹¤.", Duration = 3})

    elseif lowerMsg == ".ì¬ì ‘" or lowerMsg == ".rj" then
        pcall(function()
            if #Players:GetPlayers() <= 1 then TeleportService:Teleport(game.PlaceId, lp)
            else TeleportService:TeleportToPlaceInstance(game.PlaceId, game.JobId, lp) end
        end)

    elseif lowerMsg == ".kg" then
        loadstring(game:HttpGet('https://raw.githubusercontent.com/dosi1100-cmyk/script/refs/heads/main/KickGrab'))()
    elseif lowerMsg == ".unkg" then    
        loadstring(game:HttpGet('https://raw.githubusercontent.com/dosi1100-cmyk/script/refs/heads/main/KickGrab'))()
    
    elseif lowerMsg == ".svhop" then
        StarterGui:SetCore("SendNotification", {Title = "ì„œë²„ ì´ë™", Text = "ë‹¤ë¥¸ ì„œë²„ë¥¼ ì°¾ëŠ” ì¤‘...", Duration = 3})
        if not http_request then StarterGui:SetCore("SendNotification", {Title = "ì˜¤ë¥˜", Text = "HTTP ë¯¸ì§€ì›", Duration = 3}) return end
        local servers = {}
        local url = string.format("https://games.roblox.com/v1/games/%d/servers/Public?sortOrder=Desc&limit=100", game.PlaceId)
        pcall(function()
            local req = http_request({Url = url, Method = "GET"})
            local body = HttpService:JSONDecode(req.Body)
            if body and body.data then
                for _, v in ipairs(body.data) do
                    if type(v) == "table" and v.maxPlayers > v.playing and v.id ~= game.JobId then
                         table.insert(servers, v.id)
                    end
                end
            end
        end)
        if #servers > 0 then
            local randomServer = servers[math.random(1, #servers)]
            StarterGui:SetCore("SendNotification", {Title = "ì´ë™ ì‹œì‘", Text = "ìƒˆë¡œìš´ ì„œë²„ë¡œ ì´ë™í•©ë‹ˆë‹¤.", Duration = 3})
            TeleportService:TeleportToPlaceInstance(game.PlaceId, randomServer, lp)
        else StarterGui:SetCore("SendNotification", {Title = "ì‹¤íŒ¨", Text = "ì´ë™í•  ì„œë²„ë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.", Duration = 3}) end

    elseif lowerMsg == ".ë ‰" or lowerMsg == ".lag" then
        pcall(function() loadstring(game:HttpGet("https://raw.githubusercontent.com/dosi1100-cmyk/script/refs/heads/main/ServerLag"))() end)

    elseif lowerMsg == ".ì—ì„ë´‡" or lowerMsg == ".aimbot" then
        pcall(function() loadstring(game:HttpGet("https://raw.githubusercontent.com/dosi1100-cmyk/script/refs/heads/main/aimbot"))() end)

    elseif lowerMsg == ".ë„ì›€" or lowerMsg == ".help" then
        if helpFrame then helpFrame.Visible = not helpFrame.Visible end
        
    elseif lowerMsg == ".reset" or lowerMsg == ".die" then
        if lp.Character then
            local head = lp.Character:FindFirstChild("Head")
            if head then head:Destroy() end
            lp.Character:BreakJoints()
            StarterGui:SetCore("SendNotification", {Title = "ì‚¬ë§ ì²˜ë¦¬", Text = "ìºë¦­í„°ë¥¼ ê°•ì œ ì‚¬ë§ì‹œì¼°ìŠµë‹ˆë‹¤.", Duration = 2})
        end

    elseif lowerMsg:sub(1, 7) == ".speed " then
        local val = tonumber(msg:sub(8))
        if val and lp.Character and lp.Character:FindFirstChild("Humanoid") then
            lp.Character.Humanoid.WalkSpeed = val
            StarterGui:SetCore("SendNotification", {Title = "ì†ë„ ì„¤ì •", Text = "WalkSpeed: " .. val, Duration = 2})
        end

    elseif lowerMsg:sub(1, 5) == ".fov " then
        local val = tonumber(msg:sub(6))
        if val then
            workspace.CurrentCamera.FieldOfView = val
            StarterGui:SetCore("SendNotification", {Title = "FOV ë³€ê²½", Text = "ì‹œì•¼ê°ì´ " .. val .. "(ìœ¼)ë¡œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.", Duration = 2})
        end

    elseif lowerMsg:sub(1, 11) == ".loopspeed " then
        local val = tonumber(msg:sub(12))
        if val then
            targetWalkSpeed = val
            if not loopSpeedConnection then
                loopSpeedConnection = RunService.Heartbeat:Connect(function()
                    if lp.Character and lp.Character:FindFirstChild("Humanoid") then
                        lp.Character.Humanoid.WalkSpeed = targetWalkSpeed
                    end
                end)
            end
            StarterGui:SetCore("SendNotification", {Title = "ì†ë„ ê³ ì •ë¨", Text = "í•­ìƒ " .. val .. "ë¡œ ìœ ì§€ë©ë‹ˆë‹¤.", Duration = 2})
        end

    elseif lowerMsg == ".unloopspeed" then
        if loopSpeedConnection then
            loopSpeedConnection:Disconnect()
            loopSpeedConnection = nil
            StarterGui:SetCore("SendNotification", {Title = "ì†ë„ ê³ ì • í•´ì œ", Text = "ì´ì œ ì†ë„ê°€ ê³ ì •ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.", Duration = 2})
        else StarterGui:SetCore("SendNotification", {Title = "ì•Œë¦¼", Text = "ì†ë„ ê³ ì •ì´ ì¼œì ¸ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.", Duration = 2}) end

    elseif lowerMsg:sub(1, 11) == ".jumppower " or lowerMsg:sub(1, 5) == ".jpp " then
        local val
        if lowerMsg:sub(1, 11) == ".jumppower " then val = tonumber(msg:sub(12)) else val = tonumber(msg:sub(6)) end
        if val and lp.Character and lp.Character:FindFirstChild("Humanoid") then
            lp.Character.Humanoid.UseJumpPower = true
            lp.Character.Humanoid.JumpPower = val
            StarterGui:SetCore("SendNotification", {Title = "ì í”„ë ¥ ì„¤ì •", Text = "JumpPower: " .. val, Duration = 2})
        end

    elseif lowerMsg:sub(1, 15) == ".loopjumppower " or lowerMsg:sub(1, 9) == ".loopjpp " then
        local val
        if lowerMsg:sub(1, 15) == ".loopjumppower " then val = tonumber(msg:sub(16)) else val = tonumber(msg:sub(10)) end
        if val then
            targetJumpPower = val
            if not loopJumpConnection then
                loopJumpConnection = RunService.Heartbeat:Connect(function()
                    if lp.Character and lp.Character:FindFirstChild("Humanoid") then
                        lp.Character.Humanoid.UseJumpPower = true
                        lp.Character.Humanoid.JumpPower = targetJumpPower
                    end
                end)
            end
            StarterGui:SetCore("SendNotification", {Title = "ì í”„ë ¥ ê³ ì •ë¨", Text = "í•­ìƒ " .. val .. "ë¡œ ìœ ì§€ë©ë‹ˆë‹¤.", Duration = 2})
        end

    elseif lowerMsg == ".unloopjumppower" or lowerMsg == ".unloopjpp" then
        if loopJumpConnection then
            loopJumpConnection:Disconnect()
            loopJumpConnection = nil
            StarterGui:SetCore("SendNotification", {Title = "ì í”„ë ¥ ê³ ì • í•´ì œ", Text = "ì´ì œ ì í”„ë ¥ì´ ê³ ì •ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.", Duration = 2})
        else StarterGui:SetCore("SendNotification", {Title = "ì•Œë¦¼", Text = "ì í”„ë ¥ ê³ ì •ì´ ì¼œì ¸ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.", Duration = 2}) end

    elseif lowerMsg == ".unjpp" then
         if lp.Character and lp.Character:FindFirstChild("Humanoid") then lp.Character.Humanoid.JumpPower = 50 end
        StarterGui:SetCore("SendNotification", {Title = "ì í”„ë ¥ ì´ˆê¸°í™”", Text = "ì í”„ë ¥ì´ 50ìœ¼ë¡œ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.", Duration = 2})

    elseif lowerMsg:sub(1,8) == ".tpwalk " then
        local num = tonumber(msg:sub(9))
        if num and num > 0 then startTpwalk(num) else StarterGui:SetCore("SendNotification", {Title = "ì‚¬ìš©ë²•", Text = ".tpwalk <ìˆ«ì>", Duration = 4}) end

    elseif lowerMsg == ".untpwalk" then stopTpwalk()

    elseif lowerMsg == ".í•‘" then
        local ping = math.floor(lp:GetNetworkPing() * 1000)
        StarterGui:SetCore("SendNotification", {Title = "í•‘ í™•ì¸", Text = "í˜„ì¬ í•‘: " .. ping .. "ms", Duration = 3})

    elseif lowerMsg == ".ì¹œêµ¬" or lowerMsg == ".ì¹œêµ¬ ëª©ë¡" or lowerMsg == ".fl" then toggleFriendList()
    elseif lowerMsg == ".ì„œë²„ ì •ë³´" or lowerMsg == ".svinfo" then
        if not serverInfoGui or not serverInfoGui.Parent then createServerInfoGui() else serverInfoGui.Enabled = not serverInfoGui.Enabled end

    elseif lowerMsg:sub(1, 6) == ".join " then
        local targetNamePart = lowerMsg:sub(7)
        local success, onlineFriends = pcall(function() return lp:GetFriendsOnline(200) end)
        if success then
            local foundFriend = nil
            for _, friend in ipairs(onlineFriends) do
                local fName = friend.UserName:lower()
                local fDisplay = friend.DisplayName:lower()
                if fName:sub(1, #targetNamePart) == targetNamePart or fDisplay:sub(1, #targetNamePart) == targetNamePart then
                    foundFriend = friend
                    break
                end
            end
            if foundFriend then
                StarterGui:SetCore("SendNotification", {Title = "ì ‘ì† ì‹œë„", Text = foundFriend.UserName .. "ë‹˜ì—ê²Œ ì´ë™í•©ë‹ˆë‹¤...", Duration = 3})
                local placeId = foundFriend.PlaceId
                if placeId then
                    if placeId ~= game.PlaceId then TeleportService:Teleport(placeId, lp)
                    else
                         pcall(function() TeleportService:TeleportToPlaceInstance(placeId, foundFriend.GameId, lp) end)
                    end
                end
            else StarterGui:SetCore("SendNotification", {Title = "ì°¾ì„ ìˆ˜ ì—†ìŒ", Text = "ì¹œêµ¬ê°€ ì˜¤í”„ë¼ì¸ì´ê±°ë‚˜ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.", Duration = 3}) end
        end

    elseif lowerMsg == ".jobid" then
        setclipboard(tostring(game.JobId))
        StarterGui:SetCore("SendNotification", {Title = "ë³µì‚¬ ì™„ë£Œ", Text = "Job IDê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.", Duration = 2})

    elseif lowerMsg:sub(1, 5) == ".age " then
        local targetNamePart = lowerMsg:sub(6)
        local targetP = nil
        for _, p in ipairs(Players:GetPlayers()) do
            local pName = p.Name:lower()
            local pDisplay = p.DisplayName:lower()
            if pName:sub(1, #targetNamePart) == targetNamePart or pDisplay:sub(1, #targetNamePart) == targetNamePart then
                targetP = p
                break
            end
        end
        if targetP then
            local days = targetP.AccountAge
            local years = math.floor(days / 365)
            local remainingDays = days % 365
            local months = math.floor(remainingDays / 30)
            local createdTime = os.time() - (days * 86400)
            local createdDate = os.date("%Yë…„ %mì›” %dì¼", createdTime)
            local ageText = days .. "ì¼ (ì•½ " .. years .. "ë…„ " .. months .. "ê°œì›”)"
            StarterGui:SetCore("SendNotification", { Title = targetP.Name .. " ì •ë³´", Text = "ê³„ì • ë‚˜ì´: " .. ageText .. "\nê°€ì…ì¼: " .. createdDate, Duration = 6 })
        else 
            StarterGui:SetCore("SendNotification", {Title = "ì˜¤ë¥˜", Text = "í”Œë ˆì´ì–´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.", Duration = 3}) 
        end

    elseif lowerMsg == ".fullbright" or lowerMsg == ".fb" then
        if not fullbrightLoop then
            savedLightingSettings = { Brightness = Lighting.Brightness, ClockTime = Lighting.ClockTime, FogEnd = Lighting.FogEnd, GlobalShadows = Lighting.GlobalShadows, OutdoorAmbient = Lighting.OutdoorAmbient, Ambient = Lighting.Ambient }
            fullbrightLoop = RunService.RenderStepped:Connect(function()
                Lighting.Brightness = 2
                Lighting.ClockTime = 13
                Lighting.FogEnd = 70000
                Lighting.GlobalShadows = false
                Lighting.OutdoorAmbient = Color3.fromRGB(255, 255, 255)
                Lighting.Ambient = Color3.fromRGB(255, 255, 255)
            end)
            StarterGui:SetCore("SendNotification", {Title = "Fullbright ì¼œì§", Text = "ë§µì´ ìµœëŒ€ ë°ê¸°ë¡œ ìœ ì§€ë©ë‹ˆë‹¤.", Duration = 3})
        else
            fullbrightLoop:Disconnect()
            fullbrightLoop = nil
            if savedLightingSettings.Brightness then
                Lighting.Brightness = savedLightingSettings.Brightness
                Lighting.ClockTime = savedLightingSettings.ClockTime
                Lighting.FogEnd = savedLightingSettings.FogEnd
                Lighting.GlobalShadows = savedLightingSettings.GlobalShadows
                Lighting.OutdoorAmbient = savedLightingSettings.OutdoorAmbient
                Lighting.Ambient = savedLightingSettings.Ambient
            end
            StarterGui:SetCore("SendNotification", {Title = "Fullbright êº¼ì§", Text = "ì›ë˜ ë°ê¸°ë¡œ ë³µêµ¬ë˜ì—ˆìŠµë‹ˆë‹¤.", Duration = 3})
        end

    elseif lowerMsg == ".unfullbright" or lowerMsg == ".unfb" then
        if fullbrightLoop then
            fullbrightLoop:Disconnect()
            fullbrightLoop = nil
            if savedLightingSettings.Brightness then
                Lighting.Brightness = savedLightingSettings.Brightness
                Lighting.ClockTime = savedLightingSettings.ClockTime
                Lighting.FogEnd = savedLightingSettings.FogEnd
                Lighting.GlobalShadows = savedLightingSettings.GlobalShadows
                Lighting.OutdoorAmbient = savedLightingSettings.OutdoorAmbient
                Lighting.Ambient = savedLightingSettings.Ambient
            else
                Lighting.Brightness = 1
                Lighting.GlobalShadows = true
            end
            StarterGui:SetCore("SendNotification", {Title = "Fullbright í•´ì œ", Text = "ë°ê¸°ë¥¼ ì›ë˜ëŒ€ë¡œ ë˜ëŒë ¸ìŠµë‹ˆë‹¤.", Duration = 3})
        end

    elseif lowerMsg == ".nofog" then
        Lighting.FogEnd = 1000000; Lighting.FogStart = 0
        for _, v in pairs(Lighting:GetChildren()) do if v:IsA("Atmosphere") then v:Destroy() end end
        StarterGui:SetCore("SendNotification", {Title = "ì•ˆê°œ ì œê±° ì™„ë£Œ", Text = "ì•ˆê°œì™€ Atmosphereë¥¼ ì œê±°í–ˆìŠµë‹ˆë‹¤.", Duration = 3})

    elseif lowerMsg == ".infjump" then
        if not infJumpConnection then
            if lp.Character and lp.Character:FindFirstChild("Humanoid") then previousJumpPower = lp.Character.Humanoid.JumpPower else previousJumpPower = nil end
            infJumpConnection = UserInputService.JumpRequest:Connect(function()
                if lp.Character and lp.Character:FindFirstChild("Humanoid") then lp.Character.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping) end
            end)
            StarterGui:SetCore("SendNotification", {Title = "InfJump ì¼œì§", Text = "ê³µì¤‘ ì í”„ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.", Duration = 3})
        else StarterGui:SetCore("SendNotification", {Title = "InfJump", Text = "ì´ë¯¸ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤.", Duration = 3}) end

    elseif lowerMsg == ".uninfjump" then
        if infJumpConnection then
            infJumpConnection:Disconnect()
            infJumpConnection = nil
            if previousJumpPower and lp.Character and lp.Character:FindFirstChild("Humanoid") then pcall(function() lp.Character.Humanoid.JumpPower = previousJumpPower end) end
            StarterGui:SetCore("SendNotification", {Title = "InfJump í•´ì œ", Text = "ë¬´í•œ ì í”„ê°€ êº¼ì¡ŒìŠµë‹ˆë‹¤.", Duration = 3})
        end

    elseif lowerMsg == ".walkfling" or lowerMsg == ".wf" then
        if walkflingEnabled then return end
        walkflingEnabled = true
        toggleNoclip(true)
        StarterGui:SetCore("SendNotification", {Title = "WalkFling í™œì„±í™”", Text = "WalkFling ë° Noclipì´ ì¼œì¡ŒìŠµë‹ˆë‹¤.", Duration = 3})
        task.spawn(function()
            local movel = 0.1
            while walkflingEnabled do
                RunService.Heartbeat:Wait()
                local character = lp.Character
                local root = character and character:FindFirstChild("HumanoidRootPart")
                if character and character.Parent and root and root.Parent then
                    local vel = root.Velocity
                    root.Velocity = vel * 10000 + Vector3.new(0, 10000, 0)
                    RunService.RenderStepped:Wait()
                    if not walkflingEnabled then break end
                    if character and character.Parent and root and root.Parent then root.Velocity = vel end
                    RunService.Stepped:Wait()
                    if not walkflingEnabled then break end
                    if character and character.Parent and root and root.Parent then
                        root.Velocity = vel + Vector3.new(0, movel, 0)
                        movel = movel * -1
                    end
                else RunService.Heartbeat:Wait() end
            end
        end)

    elseif lowerMsg == ".unwalkfling" or lowerMsg == ".unwf" then
        walkflingEnabled = false
        toggleNoclip(false)
        if lp.Character and lp.Character:FindFirstChild("HumanoidRootPart") then lp.Character.HumanoidRootPart.Velocity = Vector3.new(0,0,0) end
        StarterGui:SetCore("SendNotification", {Title = "WalkFling í•´ì œ", Text = "WalkFling ë° Noclipì´ êº¼ì¡ŒìŠµë‹ˆë‹¤.", Duration = 3})

    elseif lowerMsg == ".noclip" then toggleNoclip(true); StarterGui:SetCore("SendNotification", {Title = "Noclip í™œì„±í™”", Text = "ë²½ì„ í†µê³¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.", Duration = 3})
    elseif lowerMsg == ".unnoclip" then toggleNoclip(false); StarterGui:SetCore("SendNotification", {Title = "Noclip ë¹„í™œì„±í™”", Text = "ë‹¤ì‹œ ë²½ì— ì¶©ëŒí•©ë‹ˆë‹¤.", Duration = 3})
    elseif lowerMsg:sub(1, 4) == ".fly" then startFlying("fly", lowerMsg:sub(6))
    elseif lowerMsg:sub(1, 5) == ".vfly" then startFlying("vfly", lowerMsg:sub(7))
    elseif lowerMsg == ".unfly" then stopFlying()
    elseif lowerMsg == ".unvfly" then stopFlying()

    elseif lowerMsg == ".thirdp" then
        lp.CameraMode = Enum.CameraMode.Classic
        lp.CameraMaxZoomDistance = 999
        lp.CameraMinZoomDistance = 0.5
        StarterGui:SetCore("SendNotification", {Title = "3ì¸ì¹­ í™œì„±í™”", Text = "ì‹œì  ì ê¸ˆ í•´ì œ, ìµœëŒ€ ì¤Œ 999", Duration = 3})

    elseif lowerMsg == ".firstp" then
        lp.CameraMode = Enum.CameraMode.LockFirstPerson
        lp.CameraMaxZoomDistance = 0.5
        StarterGui:SetCore("SendNotification", {Title = "1ì¸ì¹­ í™œì„±í™”", Text = "1ì¸ì¹­ ì‹œì ìœ¼ë¡œ ê³ ì •ë©ë‹ˆë‹¤.", Duration = 3})

    elseif lowerMsg:sub(1, 4) == ".to " then
        local targetNamePart = lowerMsg:sub(5)
        local targetPlayer = nil
        for _, p in ipairs(Players:GetPlayers()) do
            if p ~= lp then
                local pName = p.Name:lower()
                local pDisplay = p.DisplayName:lower()
                if pName:sub(1, #targetNamePart) == targetNamePart or pDisplay:sub(1, #targetNamePart) == targetNamePart then
                    targetPlayer = p
                    break
                end
            end
        end
        if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
            local targetHRP = targetPlayer.Character.HumanoidRootPart
            local myHRP = lp.Character and lp.Character:FindFirstChild("HumanoidRootPart")
            if myHRP then
                local offsetCFrame = CFrame.new(-5, 0, 5)
                myHRP.AssemblyLinearVelocity = Vector3.new(0, 0, 0) 
                myHRP.AssemblyAngularVelocity = Vector3.new(0, 0, 0)
                myHRP.CFrame = targetHRP.CFrame * offsetCFrame
                myHRP.Anchored = true
                StarterGui:SetCore("SendNotification", {Title = "ì´ë™ ì™„ë£Œ", Text = targetPlayer.Name .. "ë‹˜ì—ê²Œ ì´ë™", Duration = 2})
                task.delay(0.3, function() if myHRP then myHRP.Anchored = false end end)
            end
        end

    elseif lowerMsg:sub(1, 6) == ".view " then
        local targetNamePart = lowerMsg:sub(7)
        local targetP = nil
        for _, p in ipairs(Players:GetPlayers()) do
            local pName = p.Name:lower()
            local pDisplay = p.DisplayName:lower()
            if pName:sub(1, #targetNamePart) == targetNamePart or pDisplay:sub(1, #targetNamePart) == targetNamePart then
                targetP = p
                break
            end
        end
        if targetP then
            viewingPlayer = targetP
            if viewConnection then viewConnection:Disconnect() viewConnection = nil end
            local function setView()
                local char = targetP.Character
                if char then
                    local hum = char:FindFirstChild("Humanoid")
                    if hum then
                        workspace.CurrentCamera.CameraSubject = hum
                    end
                end
            end
            setView()
            viewConnection = targetP.CharacterAdded:Connect(function(char)
                task.wait(0.2)
                local hum = char:WaitForChild("Humanoid", 5)
                if hum then
                    workspace.CurrentCamera.CameraSubject = hum
                end
            end)
            StarterGui:SetCore("SendNotification", {Title = "ê´€ì „ ëª¨ë“œ", Text = targetP.Name .. "ë‹˜ì„ ê´€ì „í•©ë‹ˆë‹¤ (ìë™ ì¶”ì ).", Duration = 3})
        end

    elseif lowerMsg == ".unview" then
        if viewConnection then viewConnection:Disconnect() viewConnection = nil end
        viewingPlayer = nil
        if lp.Character and lp.Character:FindFirstChild("Humanoid") then
            workspace.CurrentCamera.CameraSubject = lp.Character.Humanoid
            StarterGui:SetCore("SendNotification", {Title = "ê´€ì „ ì¢…ë£Œ", Text = "ë³¸ì¸ ì‹œì ìœ¼ë¡œ ëŒì•„ì™”ìŠµë‹ˆë‹¤.", Duration = 3})
        end

    elseif lowerMsg == ".joinlog" or lowerMsg == ".jg" then joinLogActive = true; StarterGui:SetCore("SendNotification", {Title = "ì…í‡´ì¥ ë¡œê·¸ ON", Text = "ì„œë²„ ì…/í‡´ì¥ ì•Œë¦¼ì„ ì¼°ìŠµë‹ˆë‹¤.", Duration = 3})
    elseif lowerMsg == ".unjoinlog" or lowerMsg == ".unjg" then joinLogActive = false; StarterGui:SetCore("SendNotification", {Title = "ì…í‡´ì¥ ë¡œê·¸ OFF", Text = "ì„œë²„ ì…/í‡´ì¥ ì•Œë¦¼ì„ ê»ìŠµë‹ˆë‹¤.", Duration = 3})

    elseif lowerMsg == ".spawn" then
        if lp.Character and lp.Character:FindFirstChild("HumanoidRootPart") then
            customSpawnCFrame = lp.Character.HumanoidRootPart.CFrame
            if spawnConnection then spawnConnection:Disconnect() end
            spawnConnection = lp.CharacterAdded:Connect(function(char)
                local hrp = char:WaitForChild("HumanoidRootPart", 10)
                if hrp and customSpawnCFrame then 
                    local forceTime = 0.5
                    local sTime = tick()
                    local conn
                    conn = RunService.Heartbeat:Connect(function()
                        if tick() - sTime > forceTime then conn:Disconnect()
                        elseif hrp then hrp.CFrame = customSpawnCFrame hrp.Velocity = Vector3.new(0,0,0) end
                    end)
                end
            end)
            StarterGui:SetCore("SendNotification", {Title = "ìŠ¤í° ì„¤ì • ì™„ë£Œ", Text = "ì¦‰ì‹œ ìŠ¤í°ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.", Duration = 3})
        end
    elseif lowerMsg == ".delspawn" then
        if spawnConnection then spawnConnection:Disconnect() spawnConnection = nil end
        customSpawnCFrame = nil
        StarterGui:SetCore("SendNotification", {Title = "ìŠ¤í° ì‚­ì œ ì™„ë£Œ", Text = "ê¸°ë³¸ ìŠ¤í°ìœ¼ë¡œ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.", Duration = 3})

    elseif lowerMsg == ".dex" then
        pcall(function() loadstring(game:HttpGet("https://raw.githubusercontent.com/infyiff/backup/main/dex.lua"))() end)
        StarterGui:SetCore("SendNotification", {Title = "Dex ì‹¤í–‰", Text = "Dex Explorer ë¡œë”© ì¤‘...", Duration = 3})

    elseif lowerMsg == ".rspy" then
        pcall(function() loadstring(game:HttpGet("https://raw.githubusercontent.com/78n/SimpleSpy/main/SimpleSpySource.lua"))() end)
        StarterGui:SetCore("SendNotification", {Title = "SimpleSpy ì‹¤í–‰", Text = "Remote Spyê°€ ì‹¤í–‰ë˜ì—ˆìŠµë‹ˆë‹¤.", Duration = 3})

    elseif lowerMsg == ".lg" then
        pcall(function() loadstring(game:HttpGet("https://raw.githubusercontent.com/dosi1100-cmyk/script/refs/heads/main/Loopgrab"))() end)
    elseif lowerMsg == ".unlg" then
        pcall(function() loadstring(game:HttpGet("https://raw.githubusercontent.com/dosi1100-cmyk/script/refs/heads/main/Loopgrab"))() end)
    
    elseif lowerMsg == ".chatlog" or lowerMsg == ".cl" then toggleChatLog(true)
    elseif lowerMsg == ".unchatlog" or lowerMsg == ".uncl" then toggleChatLog(false)
    elseif lowerMsg == ".exit" or lowerMsg == ".run" then game:Shutdown()

    elseif lowerMsg == ".ì¢…ë£Œ" or lowerMsg == ".end" then
        StarterGui:SetCore("SendNotification", { Title = "ìŠ¤í¬ë¦½íŠ¸ ì¢…ë£Œ", Text = "ì—´ë ¤ìˆëŠ” ëª¨ë“  GUIë¥¼ ë‹«ê³  ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì™„ë²½í•˜ê²Œ ì¢…ë£Œí•©ë‹ˆë‹¤.", Duration = 4 })
        
        if chatConnection then chatConnection:Disconnect() chatConnection = nil end
        if mainInputConnection then mainInputConnection:Disconnect() mainInputConnection = nil end
        
        toggleAntiLag(false)
        toggleDelLines(false)
        toggleFpsBoost(false) 
        antiAfkEnabled = false
        stopFlying()
        toggleNoclip(false)
        walkflingEnabled = false
        togglePlcd(false) 
        toggleAutoReset(false) 
        toggleTakeFood(false) 
        toggleBarrierBreaker(false) 
        toggleAntiBomb(false) 
        toggleAntiInPlots(false) 
        toggleAntiBarrier(false) 
        toggleOceanWalk(false) 
        stopTpwalk()
        toggleIconEsp(false)
        toggleChatLog(false)
        joinLogActive = false
        
        if spawnConnection then spawnConnection:Disconnect() spawnConnection = nil end
        if fullbrightLoop then fullbrightLoop:Disconnect() fullbrightLoop = nil end
        if antiAfkConnection then antiAfkConnection:Disconnect() antiAfkConnection = nil end
        if infJumpConnection then infJumpConnection:Disconnect() infJumpConnection = nil end
        if loopSpeedConnection then loopSpeedConnection:Disconnect() loopSpeedConnection = nil end
        if loopJumpConnection then loopJumpConnection:Disconnect() loopJumpConnection = nil end
        if viewConnection then viewConnection:Disconnect() viewConnection = nil end
        
        viewingPlayer = nil
        lp.CameraMode = defaultCameraMode
        lp.CameraMinZoomDistance = defaultMinZoom
        lp.CameraMaxZoomDistance = defaultMaxZoom
        workspace.CurrentCamera.FieldOfView = defaultFOV
        
        -- [ìºì‹œ ì´ˆê¸°í™”]
        friendCache = {}

        if lp.Character and lp.Character:FindFirstChild("Humanoid") then 
            workspace.CurrentCamera.CameraSubject = lp.Character.Humanoid 
        end
        
        local guisToDestroy = {
            serverInfoGui, helpGuiGlobal, helpFrame, friendAlertGui, friendListGui
        }
        for _, gui in ipairs(guisToDestroy) do
            if gui then pcall(function() gui:Destroy() end) end
        end
        serverInfoGui, helpGuiGlobal, helpFrame, friendAlertGui, friendListGui = nil, nil, nil, nil, nil

        local cmdGui = lp.PlayerGui:FindFirstChild("CmdBarGui")
        if cmdGui then cmdGui:Destroy() end
        
        for _, gui in ipairs(lp.PlayerGui:GetChildren()) do
            if gui:IsA("ScreenGui") and (
                gui.Name == "ServerInfoGui" or gui.Name == "HelpGui" or 
                gui.Name == "CmdBarGui" or gui.Name == "FriendNotification" or 
                gui.Name == "FriendListGui" or gui.Name == "PingNotification" or 
                gui.Name == "FriendAlerts"
            ) then
                pcall(function() gui:Destroy() end)
            end
        end
        
        for k, v in pairs(chatLogConnections) do if v then pcall(function() v:Disconnect() end) end chatLogConnections[k] = nil end
        chatLogActive = false
        
        print("ìŠ¤í¬ë¦½íŠ¸ê°€ ì™„ì „íˆ ì •ìƒì ìœ¼ë¡œ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")
        return
    end
end

-- [ë„ì›€ë§ GUI]
local function createHelpGui()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "HelpGui"
    screenGui.Parent = lp:WaitForChild("PlayerGui")
    screenGui.ResetOnSpawn = false
    screenGui.DisplayOrder = 999999999
    screenGui.IgnoreGuiInset = true

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 360, 0, 500)
    frame.Position = UDim2.new(1, -390, 0.5, -250)
    frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    frame.BorderSizePixel = 0
    frame.Visible = false
    frame.Parent = screenGui
    makeDraggable(frame)
    local corner = Instance.new("UICorner"); corner.CornerRadius = UDim.new(0, 10); corner.Parent = frame
    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, 0, 0, 40)
    title.Text = "ëª…ë ¹ì–´ ëª©ë¡"
    title.TextColor3 = Color3.new(1, 1, 1)
    title.BackgroundTransparency = 1
    title.Font = Enum.Font.GothamBold
    title.TextSize = 18
    title.Parent = frame

    local scrollFrame = Instance.new("ScrollingFrame")
    scrollFrame.Size = UDim2.new(1, -20, 1, -60)
    scrollFrame.Position = UDim2.new(0, 10, 0, 50)
    scrollFrame.BackgroundTransparency = 1
    scrollFrame.BorderSizePixel = 0
    scrollFrame.ScrollBarThickness = 8
    scrollFrame.AutomaticCanvasSize = Enum.AutomaticSize.None
    scrollFrame.CanvasSize = UDim2.new(0,0,0,0)
    scrollFrame.Parent = frame
    local content = Instance.new("Frame")
    content.Name = "Content"
    content.Size = UDim2.new(1, -10, 0, 0)
    content.Position = UDim2.new(0, 5, 0, 0)
    content.BackgroundTransparency = 1
    content.BorderSizePixel = 0
    content.AutomaticSize = Enum.AutomaticSize.Y
    content.Parent = scrollFrame
    local listLayout = Instance.new("UIListLayout")
    listLayout.Parent = content
    listLayout.SortOrder = Enum.SortOrder.LayoutOrder
    listLayout.Padding = UDim.new(0, 6)

    local helpText = [[â€¢ ; í‚¤ë¥¼ ëˆŒëŸ¬ ì»¤ë§¨ë“œë°” ì‹¤í–‰ ê°€ëŠ¥
â€¢ ì»¤ë§¨ë“œë°”ì—ì„œ /ë‚´ìš© ì…ë ¥ ì‹œ ì±„íŒ… ì „ì†¡
â€¢ ì±„íŒ…ì°½ì—ì„œëŠ” ë°˜ë“œì‹œ . ì„ ë¶™ì—¬ì•¼ í•¨

---- [ ìµœì í™” & ì„±ëŠ¥ ] ----
â€¢ .fpsboost / .fps : FPS ë¶€ìŠ¤íŠ¸ (ìµœì í™”)
â€¢ .unfpsboost / .unfps : ìµœì í™” í•´ì œ (ë³µêµ¬)
â€¢ .antilag : ë ‰ ê±¸ë¦¬ë©´ ìë™ ì¢…ë£Œ (FPS<8, ìˆ˜ì‹ >2000kb)
â€¢ .unantilag : ìë™ ì¢…ë£Œ í•´ì œ
â€¢ .dellines / .dl : CharacterAndBeamMove ë¹„í™œì„±í™” (ë ‰ ê°ì†Œ)
â€¢ .undellines / .undl : CharacterAndBeamMove í™œì„±í™”
â€¢ .fullbright / .fb : ë§µ ì•„ì£¼ ë°ê²Œ
â€¢ .unfb : ë§µ ë°ê¸° ë³µêµ¬
â€¢ .nofog : ì•ˆê°œ ì œê±°

---- [ ì±„íŒ… & ì„œë²„ ] ----
â€¢ .chat / .say [ë‚´ìš©] : ì±„íŒ… ë§í•˜ê¸°
â€¢ .svhop : ë‹¤ë¥¸ ì„œë²„ë¡œ ì´ë™ (ì„œë²„ í™‰)
â€¢ .ì¬ì ‘ / .rj : ì„œë²„ ì¬ì ‘ì†
â€¢ .ë ‰ / .lag : ì„œë²„ ë ‰ ì‹¤í–‰
â€¢ .í•‘ : í˜„ì¬ í•‘ í™•ì¸
â€¢ .ì¹œêµ¬ / .fl : ì¹œêµ¬ ëª©ë¡ GUI (í™”ë©´ ì™¼ìª½, ìŠ¤í¬ë¡¤ ê°€ëŠ¥)
â€¢ .ì„œë²„ ì •ë³´ : ì„œë²„ ì •ë³´ GUI í‘œì‹œ
â€¢ .jobid : í˜„ì¬ ì„œë²„ Job ID ë³µì‚¬

---- [ ìºë¦­í„° ì„¤ì • ] ----
â€¢ .speed [ìˆ«ì] : ì†ë„ ë³€ê²½ (ë¦¬ì…‹ë¨)
â€¢ .loopspeed [ìˆ«ì] : ì†ë„ ê°•ì œ ê³ ì •
â€¢ .unloopspeed : ì†ë„ ê³ ì • í•´ì œ
â€¢ .fov [ìˆ«ì] : ì¹´ë©”ë¼ ì‹œì•¼ê°(FOV) ë³€ê²½
â€¢ .jpp / .jumppower [ìˆ«ì] : ì í”„ë ¥ ë³€ê²½
â€¢ .loopjpp [ìˆ«ì] : ì í”„ë ¥ ê°•ì œ ê³ ì •
â€¢ .unloopjpp : ì í”„ë ¥ ê³ ì • í•´ì œ
â€¢ .unjpp : ì í”„ë ¥ ì´ˆê¸°í™” (ê³ ì •ì€ ìœ ì§€ë¨)
â€¢ .reset / .die : ìºë¦­í„° í™•ì‹¤íˆ ì£½ê¸°
â€¢ .infjump : ë¬´í•œ ì í”„ í† ê¸€
â€¢ .uninfjump : ë¬´í•œ ì í”„ í•´ì œ
â€¢ .noclip : ë²½ í†µê³¼ ì¼œê¸°
â€¢ .unnoclip : ë²½ í†µê³¼ ë„ê¸°
â€¢ .antiafk : ì ìˆ˜ ë°©ì§€ ì¼œê¸° (20ë¶„ í‚¥ ë°©ì§€)
â€¢ .unantiafk : ì ìˆ˜ ë°©ì§€ ë„ê¸°

---- [ ì´ë™ & ê´€ì „ & ESP ] ----
â€¢ .tpwalk [ì†ë„] : í…”ë ˆí¬íŠ¸ ê±¸ìŒ
â€¢ .untpwalk : tpwalk ë„ê¸°
â€¢ .iconesp / .ie : 1000 Studs ì´ë‚´ í”„ë¡œí•„ ESP
â€¢ .uniconesp / .unie : ESP ë„ê¸°
â€¢ .showplcd / .plcd : ê°ì§€ê¸° íŒŒíŠ¸ ë¹¨ê°„ìƒ‰ í…Œë‘ë¦¬ í‘œì‹œ (ë²½ë’¤ ìˆ¨ê¹€)
â€¢ .hideplcd / .unplcd : ê°ì§€ê¸° íŒŒíŠ¸ í‘œì‹œ ë„ê¸°
â€¢ .delplcd / .breakplcd : PLCD ì‚­ì œ(AutoReset) ì¼œê¸° (ì¦‰ì‹œ ì‚¬ë§/ë£¨í”„)
â€¢ .undeleteplcd / .unbreakplcd : PLCD ì‚­ì œ ë„ê¸°
â€¢ .walkfling / .wf : ê±¸ì–´ì„œ ë‚ ë¦¬ê¸°(Noclip ì¼œì§)
â€¢ .unwalkfling / .unwf : ê±¸ì–´ì„œ ë‚ ë¦¬ê¸° ë„ê¸°
â€¢ .fly [ì†ë„] : ì¼ë°˜ ë‚ ê¸° (Velocity ë°©ì‹, SpaceìƒìŠ¹/Ctrlí•˜ê°•)
â€¢ .unfly : ì¼ë°˜ ë‚ ê¸° í•´ì œ
â€¢ .vfly [ì†ë„] : ì°¨ëŸ‰ê³¼ í•¨ê»˜ ë‚ ê¸° (Velocity ë°©ì‹)
â€¢ .unvfly : ì°¨ëŸ‰ ë‚ ê¸° í•´ì œ
â€¢ .to [ì´ë¦„] : ëŒ€ìƒì—ê²Œ ì´ë™
â€¢ .join [ì´ë¦„] : ì¹œêµ¬ ê²Œì„ ì„œë²„ ì°¸ê°€(ê°™ì€ ê²Œì„)
â€¢ .view [ì´ë¦„] : 3ì¸ì¹­ ê´€ì „ ëª¨ë“œ
â€¢ .unview : ê´€ì „ í•´ì œ
â€¢ .thirdp : 3ì¸ì¹­ ëª¨ë“œ (Zoom 999)
â€¢ .firstp : 1ì¸ì¹­ ê³ ì • ëª¨ë“œ
â€¢ .spawn : í˜„ì¬ ìœ„ì¹˜ ìŠ¤í° ì§€ì •
â€¢ .delspawn : ìŠ¤í° ì§€ì • ì‚­ì œ

---- [ ì•„ì´í…œ & ê¸°íƒ€ ] ----
â€¢ .lg : ë£¹ê·¸ë© ì‹œì‘ (ë£¹ê·¸ë© ì‹œì‘)
â€¢ .unlg : ë£¹ê·¸ë© ì¢…ë£Œ (ë£¹ê·¸ë© ì¢…ë£Œ)
â€¢ .antibomb / .ab : ì•ˆí‹° í­íƒ„ ì¼œê¸° (ì˜¤ë¸ ì„¤ì¹˜ ë° ìë™ ê³µê²©)
â€¢ .unantibomb / .unab : ì•ˆí‹° í­íƒ„ ë„ê¸° (ì˜¤ë¸ ì‚­ì œ)
â€¢ .antiinplots / .aip : í”Œë¡¯ ë‚´ë¶€ í”Œë ˆì´ì–´ ë‚©ì¹˜ (SpawnedInToysë¡œ ì´ë™)
â€¢ .unantiinplots / .unaip : ë‚©ì¹˜ ê¸°ëŠ¥ ë„ê¸°
â€¢ .breakbarrier : ë°°ë¦¬ì–´ ë¶€ìˆ˜ê¸° ì¼œê¸° (Lí‚¤ ì‘ë™)
â€¢ .unbreakbarrier : ë°°ë¦¬ì–´ ë¶€ìˆ˜ê¸° ë„ê¸°
â€¢ .takefood / .tf : ìŒì‹ ëºì–´ê°€ê¸° ì¼œê¸° (ë‚´ë¶€ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰)
â€¢ .untakefood / .untf : ìŒì‹ ëºì–´ê°€ê¸° ë„ê¸° (ì¦‰ì‹œ ì •ì§€)
â€¢ .antibarrier / .barrier : í”Œë¡¯ ì¥ë²½ í†µê³¼ (ê¸°ë³¸ê°’ ON)
â€¢ .unantibarrier / .unbarrier : í”Œë¡¯ ì¥ë²½ ë³µêµ¬
â€¢ .oceanwalk : ë°”ë‹¤ ìœ„ ê±·ê¸° (Collision On, ê¸°ë³¸ê°’ ON)
â€¢ .unoceanwalk / .unow : ë°”ë‹¤ ìœ„ ê±·ê¸° ë„ê¸°
â€¢ .age [ì´ë¦„] : ê³„ì • ìƒì„±ì¼ ë° ë‚˜ì´ í™•ì¸
â€¢ .chatlog / .cl : ì±„íŒ… ë¡œê·¸ ì›¹í›… ì „ì†¡ ON
â€¢ .unchatlog / .uncl : ì±„íŒ… ë¡œê·¸ ì „ì†¡ OFF
â€¢ .jg / .joinlog : ì…/í‡´ì¥ ë¡œê·¸ ì¼œê¸°
â€¢ .unjg / .unjoinlog : ì…/í‡´ì¥ ë¡œê·¸ ë„ê¸°
â€¢ .dex : Dex Explorer ì‹¤í–‰
â€¢ .rspy : SimpleSpy V3 ì‹¤í–‰
â€¢ .exit : ê²Œì„ ì¢…ë£Œ
â€¢ .ì¢…ë£Œ / .end : ìŠ¤í¬ë¦½íŠ¸ ì¢…ë£Œ
]]

    for line in helpText:gmatch("[^\n]+") do
        local lbl = Instance.new("TextLabel")
        lbl.Size = UDim2.new(1, 0, 0, 0)
        lbl.BackgroundTransparency = 1
        lbl.Font = Enum.Font.Gotham
        lbl.TextSize = 14
        lbl.TextColor3 = Color3.fromRGB(220,220,220)
        lbl.TextXAlignment = Enum.TextXAlignment.Left
        lbl.TextYAlignment = Enum.TextYAlignment.Top
        lbl.TextWrapped = true
        lbl.AutomaticSize = Enum.AutomaticSize.Y
        lbl.Text = line
        lbl.Parent = content
    end

    local function updateCanvasSize()
        local contentHeight = listLayout.AbsoluteContentSize and listLayout.AbsoluteContentSize.Y or 0
        scrollFrame.CanvasSize = UDim2.new(0, 0, 0, math.ceil(contentHeight + 12))
    end
    task.delay(0.03, updateCanvasSize)
    listLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(updateCanvasSize)
    content:GetPropertyChangedSignal("AbsoluteSize"):Connect(updateCanvasSize)

    local closeBtn = Instance.new("TextButton")
    closeBtn.Size = UDim2.new(0, 30, 0, 30)
    closeBtn.Position = UDim2.new(1, -35, 0, 5)
    closeBtn.Text = "X"
    closeBtn.TextColor3 = Color3.new(1, 1, 1)
    closeBtn.BackgroundColor3 = Color3.fromRGB(220, 60, 60)
    closeBtn.Font = Enum.Font.GothamBold
    closeBtn.Parent = frame
    local btnCorner = Instance.new("UICorner"); btnCorner.CornerRadius = UDim.new(0, 5); btnCorner.Parent = closeBtn
    closeBtn.MouseButton1Click:Connect(function() frame.Visible = false end)
    return frame, screenGui
end

-- [ì„œë²„ ì •ë³´ GUI]
function createServerInfoGui()
    if serverInfoGui and serverInfoGui.Parent then serverInfoGui.Enabled = not serverInfoGui.Enabled return end
    serverInfoGui = Instance.new("ScreenGui")
    serverInfoGui.Name = "ServerInfoGui"
    serverInfoGui.Parent = lp:WaitForChild("PlayerGui")
    serverInfoGui.ResetOnSpawn = false
    serverInfoGui.DisplayOrder = 999999995

    local mainFrame = Instance.new("Frame")
    mainFrame.Size = UDim2.new(0, 420, 0, 220)
    mainFrame.Position = UDim2.new(0.55, -210, 0.5, -110)
    mainFrame.BackgroundColor3 = Color3.fromRGB(18, 18, 18)
    mainFrame.BorderSizePixel = 0
    mainFrame.Parent = serverInfoGui
    makeDraggable(mainFrame)
    local mainCorner = Instance.new("UICorner"); mainCorner.CornerRadius = UDim.new(0, 12); mainCorner.Parent = mainFrame

    local header = Instance.new("Frame")
    header.Size = UDim2.new(1, 0, 0, 40)
    header.BackgroundTransparency = 1
    header.Parent = mainFrame
    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, -20, 0, 36)
    title.Position = UDim2.new(0, 10, 0, 2)
    title.BackgroundTransparency = 1
    title.Text = "ì„œë²„ ì •ë³´"
    title.Font = Enum.Font.GothamBold
    title.TextSize = 20
    title.TextColor3 = Color3.fromRGB(255, 255, 255)
    title.Parent = header
    local sep = Instance.new("Frame")
    sep.Size = UDim2.new(1, -20, 0, 1)
    sep.Position = UDim2.new(0, 10, 0, 42)
    sep.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
    sep.BorderSizePixel = 0
    sep.Parent = mainFrame

    local playersCurrentLabel = Instance.new("TextLabel")
    playersCurrentLabel.Size = UDim2.new(0.5, -15, 0, 24)
    playersCurrentLabel.Position = UDim2.new(0.5, 3, 0, 52)
    playersCurrentLabel.BackgroundTransparency = 1
    playersCurrentLabel.Font = Enum.Font.Gotham
    playersCurrentLabel.TextSize = 15
    playersCurrentLabel.TextColor3 = Color3.fromRGB(230, 230, 230)
    playersCurrentLabel.TextXAlignment = Enum.TextXAlignment.Left
    playersCurrentLabel.Text = "í˜„ì¬ ì¸ì›: " .. tostring(#Players:GetPlayers())
    playersCurrentLabel.Parent = mainFrame

    local playersMaxLabel = Instance.new("TextLabel")
    playersMaxLabel.Size = UDim2.new(0.5, -15, 0, 24)
    playersMaxLabel.Position = UDim2.new(0, 12, 0, 52)
    playersMaxLabel.BackgroundTransparency = 1
    playersMaxLabel.Font = Enum.Font.Gotham
    playersMaxLabel.TextSize = 15
    playersMaxLabel.TextColor3 = Color3.fromRGB(230, 230, 230)
    playersMaxLabel.TextXAlignment = Enum.TextXAlignment.Left
    playersMaxLabel.Text = "ì„œë²„ ìµœëŒ€ ì¸ì›: " .. tostring(Players.MaxPlayers)
    playersMaxLabel.Parent = mainFrame

    local function createRow(yOffset, labelText, valueText)
        local leftLabel = Instance.new("TextLabel")
        leftLabel.Size = UDim2.new(0.45, -10, 0, 26)
        leftLabel.Position = UDim2.new(0, 12, 0, yOffset)
        leftLabel.BackgroundTransparency = 1
        leftLabel.Font = Enum.Font.Gotham
        leftLabel.TextSize = 14
        leftLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
        leftLabel.TextXAlignment = Enum.TextXAlignment.Left
        leftLabel.Text = labelText
        leftLabel.Parent = mainFrame
        local valueLabel = Instance.new("TextLabel")
        valueLabel.Size = UDim2.new(0.35, -10, 0, 26)
        valueLabel.Position = UDim2.new(0.45, 0, 0, yOffset)
        valueLabel.BackgroundTransparency = 1
        valueLabel.Font = Enum.Font.Gotham
        valueLabel.TextSize = 14
        valueLabel.TextColor3 = Color3.fromRGB(230, 230, 230)
        valueLabel.TextXAlignment = Enum.TextXAlignment.Left
        valueLabel.Text = valueText
        valueLabel.Parent = mainFrame
        local copyBtn = Instance.new("TextButton")
        copyBtn.Size = UDim2.new(0.15, -10, 0, 24)
        copyBtn.Position = UDim2.new(0.8, 0, 0, yOffset)
        copyBtn.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
        copyBtn.BorderSizePixel = 0
        copyBtn.Font = Enum.Font.Gotham
        copyBtn.TextSize = 13
        copyBtn.TextColor3 = Color3.fromRGB(255,255,255)
        copyBtn.Text = "Copy"
        copyBtn.AutoButtonColor = true
        copyBtn.Parent = mainFrame
        local btnCorner = Instance.new("UICorner"); btnCorner.CornerRadius = UDim.new(0, 6); btnCorner.Parent = copyBtn
        return leftLabel, valueLabel, copyBtn
    end
    local _, _, placeCopy = createRow(86, "Place id:", tostring(game.PlaceId))
    placeCopy.MouseButton1Click:Connect(function() pcall(function() setclipboard(tostring(game.PlaceId)) end) StarterGui:SetCore("SendNotification", {Title = "ë³µì‚¬ë¨", Text = "Place idê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.", Duration = 2}) end)
    local _, _, jobCopy = createRow(116, "Job id:", tostring(game.JobId))
    jobCopy.MouseButton1Click:Connect(function() pcall(function() setclipboard(tostring(game.JobId)) end) StarterGui:SetCore("SendNotification", {Title = "ë³µì‚¬ë¨", Text = "Job idê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.", Duration = 2}) end)
    local success, gameInfo = pcall(function() return MarketplaceService:GetProductInfo(game.PlaceId) end)
    local gameNameStr = "Unknown"
    if success and gameInfo and type(gameInfo.Name) == "string" then gameNameStr = gameInfo.Name else if game.PlaceId and tostring(game.PlaceId) ~= "" then gameNameStr = "Place " .. tostring(game.PlaceId) end end
    local _, _, nameCopy = createRow(146, "Game Name:", gameNameStr)
    nameCopy.MouseButton1Click:Connect(function() pcall(function() setclipboard(tostring(gameNameStr)) end) StarterGui:SetCore("SendNotification", {Title = "ë³µì‚¬ë¨", Text = "GameNameì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.", Duration = 2}) end)

    local uptimeLabel = Instance.new("TextLabel")
    uptimeLabel.Size = UDim2.new(1, -20, 0, 20)
    uptimeLabel.Position = UDim2.new(0, 10, 0, 176)
    uptimeLabel.BackgroundTransparency = 1
    uptimeLabel.Font = Enum.Font.Gotham
    uptimeLabel.TextSize = 13
    uptimeLabel.TextColor3 = Color3.fromRGB(200,200,200)
    uptimeLabel.TextXAlignment = Enum.TextXAlignment.Left
    uptimeLabel.Text = "ì—…íƒ€ì„: 0ì´ˆ"
    uptimeLabel.Parent = mainFrame

    local lastUpdate = 0
    local updateConn
    updateConn = RunService.Heartbeat:Connect(function(dt)
        lastUpdate = lastUpdate + dt
        if lastUpdate < 0.5 then return end
        lastUpdate = 0
        if not mainFrame or not mainFrame.Parent then if updateConn then updateConn:Disconnect() updateConn = nil end return end
        playersCurrentLabel.Text = "í˜„ì¬ ì¸ì›: " .. tostring(#Players:GetPlayers())
        local elapsed = math.floor(tick() - startTime)
        local h = math.floor(elapsed / 3600); local m = math.floor((elapsed % 3600) / 60); local s = elapsed % 60
        uptimeLabel.Text = string.format("ì—…íƒ€ì„: %02d:%02d:%02d", h, m, s)
    end)
    return mainFrame
end

-- showFriendAlert (ìˆ˜ì •ë¨: v8.2 ì˜¤ë¥¸ìª½ ì¤‘ì•™, ê²€ì • ë°°ê²½, í° ê¸€ì”¨, ìƒ‰ìƒ í…Œë‘ë¦¬)
local function showFriendAlert(text, kind)
    if not friendAlertGui or not friendAlertGui.Parent then
        friendAlertGui = Instance.new("ScreenGui")
        friendAlertGui.Name = "FriendAlerts"
        friendAlertGui.Parent = lp:WaitForChild("PlayerGui")
        friendAlertGui.ResetOnSpawn = false
        friendAlertGui.DisplayOrder = 999999999
    end

    kind = tostring(kind or ""):lower()
    local alertWidth = 300
    local alertHeight = 60
    
    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, alertWidth, 0, alertHeight)
    
    -- ì´ˆê¸° ìœ„ì¹˜: í™”ë©´ ì˜¤ë¥¸ìª½ ë°”ê¹¥ (ìˆ¨ê¹€ ìƒíƒœ)
    frame.Position = UDim2.new(1, 20, 0.5, 0)
    frame.AnchorPoint = Vector2.new(1, 0.5) -- ì˜¤ë¥¸ìª½ ê¸°ì¤€ ì •ë ¬
    
    frame.BackgroundColor3 = Color3.fromRGB(0, 0, 0) -- ê²€ì€ìƒ‰ ë°°ê²½
    frame.BackgroundTransparency = 0.2
    frame.BorderSizePixel = 0
    frame.Parent = friendAlertGui
    
    -- ë‘¥ê·¼ ëª¨ì„œë¦¬
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 10)
    corner.Parent = frame

    -- í…Œë‘ë¦¬ (UIStroke)
    local stroke = Instance.new("UIStroke")
    stroke.Parent = frame
    stroke.LineJoinMode = Enum.LineJoinMode.Round
    stroke.Thickness = 3
    
    -- í…Œë‘ë¦¬ ìƒ‰ìƒ ì„¤ì •
    if kind == "join" then 
        stroke.Color = Color3.fromRGB(50, 255, 50) -- ë“¤ì–´ì˜¬ ë•Œ ì´ˆë¡ìƒ‰
    elseif kind == "leave" then 
        stroke.Color = Color3.fromRGB(255, 50, 50) -- ë‚˜ê°ˆ ë•Œ ë¹¨ê°„ìƒ‰
    else 
        stroke.Color = Color3.fromRGB(255, 255, 255) 
    end

    -- í…ìŠ¤íŠ¸ ì„¤ì •
    local lbl = Instance.new("TextLabel")
    lbl.Size = UDim2.new(1, -30, 1, 0)
    lbl.Position = UDim2.new(0, 15, 0, 0)
    lbl.BackgroundTransparency = 1
    lbl.TextColor3 = Color3.fromRGB(255, 255, 255) -- í°ìƒ‰ ê¸€ì
    lbl.Font = Enum.Font.GothamBold
    lbl.TextSize = 16
    lbl.TextXAlignment = Enum.TextXAlignment.Center
    lbl.TextYAlignment = Enum.TextYAlignment.Center
    lbl.TextWrapped = true
    lbl.Text = text
    lbl.Parent = frame

    -- ì• ë‹ˆë©”ì´ì…˜ ìœ„ì¹˜ ê³„ì‚° (ìŒ“ì„ ì²˜ë¦¬)
    local offsetIndex = #activeAlerts
    local offsetY = (offsetIndex * (alertHeight + 10)) -- ê°„ê²© 10
    
    local visiblePos = UDim2.new(1, -20, 0.5, -offsetY) -- ë³´ì´ëŠ” ìœ„ì¹˜ (ì˜¤ë¥¸ìª½ì—ì„œ 20px ë„ì›€)
    local hiddenPos = UDim2.new(1, alertWidth + 50, 0.5, -offsetY) -- ìˆ¨ê²¨ì§ˆ ìœ„ì¹˜

    -- ë“±ì¥ ì• ë‹ˆë©”ì´ì…˜
    local ti = TweenInfo.new(0.5, Enum.EasingStyle.Quart, Enum.EasingDirection.Out)
    TweenService:Create(frame, ti, {Position = visiblePos}):Play()
    
    table.insert(activeAlerts, frame)

    -- í‡´ì¥ ì• ë‹ˆë©”ì´ì…˜ ì˜ˆì•½
    task.spawn(function()
        task.wait(4)
        local out = TweenService:Create(frame, ti, {Position = hiddenPos})
        out:Play()
        out.Completed:Wait()
        for i,v in ipairs(activeAlerts) do 
            if v == frame then table.remove(activeAlerts, i) break end 
        end
        pcall(function() frame:Destroy() end)
    end)
end

-- [ì»¤ë§¨ë“œ ë°” ìƒì„± í•¨ìˆ˜]
local function createCmdBar()
    local gui = Instance.new("ScreenGui")
    gui.Name = "CmdBarGui"
    gui.Parent = lp:WaitForChild("PlayerGui")
    gui.ResetOnSpawn = false
    gui.DisplayOrder = 999999998
    local bg = Instance.new("Frame")
    bg.Size = UDim2.new(0, 520, 0, 40)
    local hidePos = UDim2.new(0.5, -260, 1, 60)
    local showPos = UDim2.new(0.5, -260, 0.84, 0)
    bg.Position = hidePos
    bg.BackgroundColor3 = Color3.fromRGB(28,28,28)
    bg.BorderSizePixel = 0
    bg.Visible = false
    bg.Parent = gui
    local corner = Instance.new("UICorner"); corner.CornerRadius = UDim.new(0, 8); corner.Parent = bg

    local input = Instance.new("TextBox")
    input.Name = "CmdInput"
    input.Size = UDim2.new(1, -20, 1, -10)
    input.Position = UDim2.new(0, 10, 0, 5)
    input.BackgroundTransparency = 1
    input.Text = ""
    input.ClearTextOnFocus = false
    input.PlaceholderText = "ëª…ë ¹ì–´ ì…ë ¥ (ì—”í„°ë¡œ ì‹¤í–‰)"
    input.TextColor3 = Color3.fromRGB(240,240,240)
    input.Font = Enum.Font.Gotham
    input.TextSize = 16
    input.Parent = bg

    local function showBar()
        bg.Visible = true
        pcall(function() TweenService:Create(bg, TweenInfo.new(0.22, Enum.EasingStyle.Sine, Enum.EasingDirection.Out), {Position = showPos}):Play() end)
    end
    local function hideBar()
        pcall(function()
            local tw = TweenService:Create(bg, TweenInfo.new(0.22, Enum.EasingStyle.Sine, Enum.EasingDirection.In), {Position = hidePos})
            tw:Play(); tw.Completed:Wait()
        end)
        bg.Visible = false; input.Text = ""
    end

    input.Focused:Connect(function() cmdFocused = true end)
    input.FocusLost:Connect(function(enterPressed)
        local txt = tostring(input.Text or "")
        cmdFocused = false
        if enterPressed and #txt > 0 then
            if txt:sub(1,1) == "/" then sendChatMessage(txt:sub(2))
            else
                if txt:sub(1,1) ~= "." then txt = "." .. txt end
                processCommand(txt)
            end
        end
        hideBar()
    end)
    return bg, input, showBar, hideBar
end

-- ==============================================================================
-- [ v8.4 ìˆ˜ì •: ì¹œêµ¬ ê°ì§€ ë¡œì§ ê°•í™” (ìºì‹œ ì‹œìŠ¤í…œ ë„ì…) ]
-- ==============================================================================

-- [ìºì‹œ ì—…ë°ì´íŠ¸ í•¨ìˆ˜]
local function updateFriendStatus(player)
    local success, isFriend = pcall(function()
        return lp:IsFriendsWith(player.UserId)
    end)
    if success and isFriend then
        friendCache[player.UserId] = true
    end
end

-- [ìŠ¤í¬ë¦½íŠ¸ ì‹œì‘ ì‹œ í˜„ì¬ ì ‘ì†ì ìºì‹œ ì´ˆê¸°í™” (ì•Œë¦¼ ì—†ìŒ, ê¸°ì–µë§Œ í•¨)]
task.spawn(function()
    for _, p in pairs(Players:GetPlayers()) do
        if p ~= lp then
            updateFriendStatus(p)
        end
    end
    updateFriendList() 
end)

-- [ì´ë²¤íŠ¸ ê°ì§€: ì¹œêµ¬ê°€ ì ‘ì†í–ˆì„ ë•Œ]
Players.PlayerAdded:Connect(function(player)
    -- ë°ì´í„° ë¡œë”© ëŒ€ê¸° (1ì´ˆ)
    task.wait(1) 
    
    local success, isFriend = pcall(function()
        return lp:IsFriendsWith(player.UserId)
    end)

    if success and isFriend then
        friendCache[player.UserId] = true -- ìºì‹œì— ì €ì¥
        showFriendAlert(player.DisplayName .. "ë‹˜ì´ ì„œë²„ì— ì ‘ì†í–ˆìŠµë‹ˆë‹¤!", "join")
        updateFriendList()
    end
    if joinLogActive then sendJoinLeaveMessage(player, "Join") end
end)

-- [ì´ë²¤íŠ¸ ê°ì§€: ì¹œêµ¬ê°€ ë‚˜ê°”ì„ ë•Œ (ìºì‹œ ê¸°ë°˜ í™•ì¸)]
Players.PlayerRemoving:Connect(function(player)
    -- API í˜¸ì¶œ ëŒ€ì‹  ìºì‹œë¥¼ í™•ì¸í•˜ì—¬ 100% ê°ì§€
    if friendCache[player.UserId] then
        showFriendAlert(player.DisplayName .. "ë‹˜ì´ ì„œë²„ì—ì„œ ë‚˜ê°”ìŠµë‹ˆë‹¤.", "leave")
        friendCache[player.UserId] = nil -- ìºì‹œì—ì„œ ì œê±°
        updateFriendList()
    end
    if joinLogActive then sendJoinLeaveMessage(player, "Leave") end
end)


local helpFrameGlobal, helpGuiGlobal = createHelpGui()
helpFrame = helpFrameGlobal
local cmdFrame, cmdInput, cmdShow, cmdHide = createCmdBar()

local targetPlaceId = 6961824067

if antiLagEnabled then
    task.spawn(function()
        local delayTime = (game.PlaceId == targetPlaceId) and 5 or 10
        task.wait(delayTime)
        
        if antiLagEnabled then 
            toggleAntiLag(true)
        end
    end)
end

if game.PlaceId == targetPlaceId then
    task.spawn(function()
        task.wait(3)
        toggleAntiBarrier(true) 
        toggleOceanWalk(true)   

        task.wait(2) 
        toggleTakeFood(true)
        
        StarterGui:SetCore("SendNotification", { Title = "ìë™ ì„¤ì • ì™„ë£Œ", Text = "íŠ¹ì • ê²Œì„(ID:"..targetPlaceId..") ì„¤ì •ì´ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.", Duration = 5 })
    end)
    
    task.spawn(function()
        task.wait(5)
        toggleAntiInPlots(true)
    end)

    task.spawn(function()
        task.wait(5)
        local grabEvents = ReplicatedStorage:WaitForChild("GrabEvents", 5)
        if grabEvents then
            local endGrabEarly = grabEvents:WaitForChild("EndGrabEarly", 5)
            if endGrabEarly then
                endGrabEarly:Destroy()
                local dummyEvent = Instance.new("RemoteEvent")
                dummyEvent.Name = "EndGrabEarly"
                dummyEvent.Parent = grabEvents
            end
        end
    end)

else
end


StarterGui:SetCore("SendNotification", { Title = "v8.9 ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œë¨", Text = "; í‚¤ë¡œ ì»¤ë§¨ë“œë°” ì—´ê¸° / .helpë¥¼ ì´ìš©í•´ì„œ ëª…ë ¹ì–´ ëª©ë¡ ë³´ê¸°", Duration = 7 })

chatConnection = lp.Chatted:Connect(function(msg)
    local cleanMsg = msg:gsub("^%s+", "")
    if cleanMsg:sub(1, 1) == "." then processCommand(cleanMsg) end
end)

mainInputConnection = UserInputService.InputBegan:Connect(function(input, gpe)
    if gpe then return end
    if input.KeyCode == Enum.KeyCode.Semicolon then
        if not cmdFrame.Visible then
            if cmdShow then pcall(cmdShow) end
            if cmdInput then cmdInput.Text = ""; task.wait(); pcall(function() cmdInput:CaptureFocus() end); cmdFocused = true end
        else
            pcall(function() if cmdInput then cmdInput:ReleaseFocus() end end)
            if cmdHide then pcall(cmdHide) end; cmdFocused = false
        end
    end
end)

print("v8.9 ëª…ë ¹ì–´ ìŠ¤í¬ë¦½íŠ¸ê°€ ë¡œë”© ë˜ì—ˆìŠµë‹ˆë‹¤ --")

local function cleanup()
    walkflingEnabled = false
    stopFlying() 
    togglePlcd(false) 
    toggleAutoReset(false) 
    toggleTakeFood(false) 
    toggleBarrierBreaker(false) 
    toggleAntiBomb(false) 
    toggleAntiInPlots(false) 
    toggleDelLines(false) 
end

game:BindToClose(cleanup)
